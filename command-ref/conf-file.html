<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>nix.conf</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../quick-start.html"><strong aria-hidden="true">2.</strong> Quick Start</a></li><li class="chapter-item expanded "><a href="../installation/installation.html"><strong aria-hidden="true">3.</strong> Installation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../installation/supported-platforms.html"><strong aria-hidden="true">3.1.</strong> Supported Platforms</a></li><li class="chapter-item expanded "><a href="../installation/installing-binary.html"><strong aria-hidden="true">3.2.</strong> Installing a Binary Distribution</a></li><li class="chapter-item expanded "><a href="../installation/installing-source.html"><strong aria-hidden="true">3.3.</strong> Installing Nix from Source</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../installation/prerequisites-source.html"><strong aria-hidden="true">3.3.1.</strong> Prerequisites</a></li><li class="chapter-item expanded "><a href="../installation/obtaining-source.html"><strong aria-hidden="true">3.3.2.</strong> Obtaining a Source Distribution</a></li><li class="chapter-item expanded "><a href="../installation/building-source.html"><strong aria-hidden="true">3.3.3.</strong> Building Nix from Source</a></li></ol></li><li class="chapter-item expanded "><a href="../installation/installing-docker.html"><strong aria-hidden="true">3.4.</strong> Using Nix within Docker</a></li><li class="chapter-item expanded "><a href="../installation/nix-security.html"><strong aria-hidden="true">3.5.</strong> Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../installation/single-user.html"><strong aria-hidden="true">3.5.1.</strong> Single-User Mode</a></li><li class="chapter-item expanded "><a href="../installation/multi-user.html"><strong aria-hidden="true">3.5.2.</strong> Multi-User Mode</a></li></ol></li><li class="chapter-item expanded "><a href="../installation/env-variables.html"><strong aria-hidden="true">3.6.</strong> Environment Variables</a></li><li class="chapter-item expanded "><a href="../installation/upgrading.html"><strong aria-hidden="true">3.7.</strong> Upgrading Nix</a></li></ol></li><li class="chapter-item expanded "><a href="../package-management/package-management.html"><strong aria-hidden="true">4.</strong> Package Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../package-management/basic-package-mgmt.html"><strong aria-hidden="true">4.1.</strong> Basic Package Management</a></li><li class="chapter-item expanded "><a href="../package-management/profiles.html"><strong aria-hidden="true">4.2.</strong> Profiles</a></li><li class="chapter-item expanded "><a href="../package-management/garbage-collection.html"><strong aria-hidden="true">4.3.</strong> Garbage Collection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../package-management/garbage-collector-roots.html"><strong aria-hidden="true">4.3.1.</strong> Garbage Collector Roots</a></li></ol></li><li class="chapter-item expanded "><a href="../package-management/channels.html"><strong aria-hidden="true">4.4.</strong> Channels</a></li><li class="chapter-item expanded "><a href="../package-management/sharing-packages.html"><strong aria-hidden="true">4.5.</strong> Sharing Packages Between Machines</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../package-management/binary-cache-substituter.html"><strong aria-hidden="true">4.5.1.</strong> Serving a Nix store via HTTP</a></li><li class="chapter-item expanded "><a href="../package-management/copy-closure.html"><strong aria-hidden="true">4.5.2.</strong> Copying Closures via SSH</a></li><li class="chapter-item expanded "><a href="../package-management/ssh-substituter.html"><strong aria-hidden="true">4.5.3.</strong> Serving a Nix store via SSH</a></li><li class="chapter-item expanded "><a href="../package-management/s3-substituter.html"><strong aria-hidden="true">4.5.4.</strong> Serving a Nix store via S3</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../language/index.html"><strong aria-hidden="true">5.</strong> Nix Language</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language/values.html"><strong aria-hidden="true">5.1.</strong> Data Types</a></li><li class="chapter-item expanded "><a href="../language/constructs.html"><strong aria-hidden="true">5.2.</strong> Language Constructs</a></li><li class="chapter-item expanded "><a href="../language/operators.html"><strong aria-hidden="true">5.3.</strong> Operators</a></li><li class="chapter-item expanded "><a href="../language/derivations.html"><strong aria-hidden="true">5.4.</strong> Derivations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language/advanced-attributes.html"><strong aria-hidden="true">5.4.1.</strong> Advanced Attributes</a></li></ol></li><li class="chapter-item expanded "><a href="../language/builtin-constants.html"><strong aria-hidden="true">5.5.</strong> Built-in Constants</a></li><li class="chapter-item expanded "><a href="../language/builtins.html"><strong aria-hidden="true">5.6.</strong> Built-in Functions</a></li></ol></li><li class="chapter-item expanded "><a href="../advanced-topics/advanced-topics.html"><strong aria-hidden="true">6.</strong> Advanced Topics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../advanced-topics/distributed-builds.html"><strong aria-hidden="true">6.1.</strong> Remote Builds</a></li><li class="chapter-item expanded "><a href="../advanced-topics/cores-vs-jobs.html"><strong aria-hidden="true">6.2.</strong> Tuning Cores and Jobs</a></li><li class="chapter-item expanded "><a href="../advanced-topics/diff-hook.html"><strong aria-hidden="true">6.3.</strong> Verifying Build Reproducibility</a></li><li class="chapter-item expanded "><a href="../advanced-topics/post-build-hook.html"><strong aria-hidden="true">6.4.</strong> Using the post-build-hook</a></li></ol></li><li class="chapter-item expanded "><a href="../command-ref/command-ref.html"><strong aria-hidden="true">7.</strong> Command Reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/opt-common.html"><strong aria-hidden="true">7.1.</strong> Common Options</a></li><li class="chapter-item expanded "><a href="../command-ref/env-common.html"><strong aria-hidden="true">7.2.</strong> Common Environment Variables</a></li><li class="chapter-item expanded "><a href="../command-ref/main-commands.html"><strong aria-hidden="true">7.3.</strong> Main Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/nix-env.html"><strong aria-hidden="true">7.3.1.</strong> nix-env</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-build.html"><strong aria-hidden="true">7.3.2.</strong> nix-build</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-shell.html"><strong aria-hidden="true">7.3.3.</strong> nix-shell</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-store.html"><strong aria-hidden="true">7.3.4.</strong> nix-store</a></li></ol></li><li class="chapter-item expanded "><a href="../command-ref/utilities.html"><strong aria-hidden="true">7.4.</strong> Utilities</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/nix-channel.html"><strong aria-hidden="true">7.4.1.</strong> nix-channel</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-collect-garbage.html"><strong aria-hidden="true">7.4.2.</strong> nix-collect-garbage</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-copy-closure.html"><strong aria-hidden="true">7.4.3.</strong> nix-copy-closure</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-daemon.html"><strong aria-hidden="true">7.4.4.</strong> nix-daemon</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-hash.html"><strong aria-hidden="true">7.4.5.</strong> nix-hash</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-instantiate.html"><strong aria-hidden="true">7.4.6.</strong> nix-instantiate</a></li><li class="chapter-item expanded "><a href="../command-ref/nix-prefetch-url.html"><strong aria-hidden="true">7.4.7.</strong> nix-prefetch-url</a></li></ol></li><li class="chapter-item expanded "><a href="../command-ref/experimental-commands.html"><strong aria-hidden="true">7.5.</strong> Experimental Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix.html"><strong aria-hidden="true">7.5.1.</strong> nix</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-build.html"><strong aria-hidden="true">7.5.2.</strong> nix build</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-bundle.html"><strong aria-hidden="true">7.5.3.</strong> nix bundle</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-copy.html"><strong aria-hidden="true">7.5.4.</strong> nix copy</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-daemon.html"><strong aria-hidden="true">7.5.5.</strong> nix daemon</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-describe-stores.html"><strong aria-hidden="true">7.5.6.</strong> nix describe-stores</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-develop.html"><strong aria-hidden="true">7.5.7.</strong> nix develop</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-doctor.html"><strong aria-hidden="true">7.5.8.</strong> nix doctor</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-edit.html"><strong aria-hidden="true">7.5.9.</strong> nix edit</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-eval.html"><strong aria-hidden="true">7.5.10.</strong> nix eval</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake.html"><strong aria-hidden="true">7.5.11.</strong> nix flake</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-archive.html"><strong aria-hidden="true">7.5.12.</strong> nix flake archive</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-check.html"><strong aria-hidden="true">7.5.13.</strong> nix flake check</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-clone.html"><strong aria-hidden="true">7.5.14.</strong> nix flake clone</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-info.html"><strong aria-hidden="true">7.5.15.</strong> nix flake info</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-init.html"><strong aria-hidden="true">7.5.16.</strong> nix flake init</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-lock.html"><strong aria-hidden="true">7.5.17.</strong> nix flake lock</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-metadata.html"><strong aria-hidden="true">7.5.18.</strong> nix flake metadata</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-new.html"><strong aria-hidden="true">7.5.19.</strong> nix flake new</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-prefetch.html"><strong aria-hidden="true">7.5.20.</strong> nix flake prefetch</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-show.html"><strong aria-hidden="true">7.5.21.</strong> nix flake show</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-flake-update.html"><strong aria-hidden="true">7.5.22.</strong> nix flake update</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-fmt.html"><strong aria-hidden="true">7.5.23.</strong> nix fmt</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-hash.html"><strong aria-hidden="true">7.5.24.</strong> nix hash</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-hash-file.html"><strong aria-hidden="true">7.5.25.</strong> nix hash file</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-hash-path.html"><strong aria-hidden="true">7.5.26.</strong> nix hash path</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-hash-to-base16.html"><strong aria-hidden="true">7.5.27.</strong> nix hash to-base16</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-hash-to-base32.html"><strong aria-hidden="true">7.5.28.</strong> nix hash to-base32</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-hash-to-base64.html"><strong aria-hidden="true">7.5.29.</strong> nix hash to-base64</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-hash-to-sri.html"><strong aria-hidden="true">7.5.30.</strong> nix hash to-sri</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-help.html"><strong aria-hidden="true">7.5.31.</strong> nix help</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-key.html"><strong aria-hidden="true">7.5.32.</strong> nix key</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-key-convert-secret-to-public.html"><strong aria-hidden="true">7.5.33.</strong> nix key convert-secret-to-public</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-key-generate-secret.html"><strong aria-hidden="true">7.5.34.</strong> nix key generate-secret</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-log.html"><strong aria-hidden="true">7.5.35.</strong> nix log</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-nar.html"><strong aria-hidden="true">7.5.36.</strong> nix nar</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-nar-cat.html"><strong aria-hidden="true">7.5.37.</strong> nix nar cat</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-nar-dump-path.html"><strong aria-hidden="true">7.5.38.</strong> nix nar dump-path</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-nar-ls.html"><strong aria-hidden="true">7.5.39.</strong> nix nar ls</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-path-info.html"><strong aria-hidden="true">7.5.40.</strong> nix path-info</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-print-dev-env.html"><strong aria-hidden="true">7.5.41.</strong> nix print-dev-env</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile.html"><strong aria-hidden="true">7.5.42.</strong> nix profile</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile-diff-closures.html"><strong aria-hidden="true">7.5.43.</strong> nix profile diff-closures</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile-history.html"><strong aria-hidden="true">7.5.44.</strong> nix profile history</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile-install.html"><strong aria-hidden="true">7.5.45.</strong> nix profile install</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile-list.html"><strong aria-hidden="true">7.5.46.</strong> nix profile list</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile-remove.html"><strong aria-hidden="true">7.5.47.</strong> nix profile remove</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile-rollback.html"><strong aria-hidden="true">7.5.48.</strong> nix profile rollback</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile-upgrade.html"><strong aria-hidden="true">7.5.49.</strong> nix profile upgrade</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-profile-wipe-history.html"><strong aria-hidden="true">7.5.50.</strong> nix profile wipe-history</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-realisation.html"><strong aria-hidden="true">7.5.51.</strong> nix realisation</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-realisation-info.html"><strong aria-hidden="true">7.5.52.</strong> nix realisation info</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-registry.html"><strong aria-hidden="true">7.5.53.</strong> nix registry</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-registry-add.html"><strong aria-hidden="true">7.5.54.</strong> nix registry add</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-registry-list.html"><strong aria-hidden="true">7.5.55.</strong> nix registry list</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-registry-pin.html"><strong aria-hidden="true">7.5.56.</strong> nix registry pin</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-registry-remove.html"><strong aria-hidden="true">7.5.57.</strong> nix registry remove</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-repl.html"><strong aria-hidden="true">7.5.58.</strong> nix repl</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-run.html"><strong aria-hidden="true">7.5.59.</strong> nix run</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-search.html"><strong aria-hidden="true">7.5.60.</strong> nix search</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-shell.html"><strong aria-hidden="true">7.5.61.</strong> nix shell</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-show-config.html"><strong aria-hidden="true">7.5.62.</strong> nix show-config</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-show-derivation.html"><strong aria-hidden="true">7.5.63.</strong> nix show-derivation</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store.html"><strong aria-hidden="true">7.5.64.</strong> nix store</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-add-file.html"><strong aria-hidden="true">7.5.65.</strong> nix store add-file</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-add-path.html"><strong aria-hidden="true">7.5.66.</strong> nix store add-path</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-cat.html"><strong aria-hidden="true">7.5.67.</strong> nix store cat</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-copy-log.html"><strong aria-hidden="true">7.5.68.</strong> nix store copy-log</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-copy-sigs.html"><strong aria-hidden="true">7.5.69.</strong> nix store copy-sigs</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-delete.html"><strong aria-hidden="true">7.5.70.</strong> nix store delete</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-diff-closures.html"><strong aria-hidden="true">7.5.71.</strong> nix store diff-closures</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-dump-path.html"><strong aria-hidden="true">7.5.72.</strong> nix store dump-path</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-gc.html"><strong aria-hidden="true">7.5.73.</strong> nix store gc</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-ls.html"><strong aria-hidden="true">7.5.74.</strong> nix store ls</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-make-content-addressed.html"><strong aria-hidden="true">7.5.75.</strong> nix store make-content-addressed</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-optimise.html"><strong aria-hidden="true">7.5.76.</strong> nix store optimise</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-path-from-hash-part.html"><strong aria-hidden="true">7.5.77.</strong> nix store path-from-hash-part</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-ping.html"><strong aria-hidden="true">7.5.78.</strong> nix store ping</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-prefetch-file.html"><strong aria-hidden="true">7.5.79.</strong> nix store prefetch-file</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-repair.html"><strong aria-hidden="true">7.5.80.</strong> nix store repair</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-sign.html"><strong aria-hidden="true">7.5.81.</strong> nix store sign</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-store-verify.html"><strong aria-hidden="true">7.5.82.</strong> nix store verify</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-upgrade-nix.html"><strong aria-hidden="true">7.5.83.</strong> nix upgrade-nix</a></li><li class="chapter-item expanded "><a href="../command-ref/new-cli/nix3-why-depends.html"><strong aria-hidden="true">7.5.84.</strong> nix why-depends</a></li></ol></li><li class="chapter-item expanded "><a href="../command-ref/files.html"><strong aria-hidden="true">7.6.</strong> Files</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../command-ref/conf-file.html" class="active"><strong aria-hidden="true">7.6.1.</strong> nix.conf</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../glossary.html"><strong aria-hidden="true">8.</strong> Glossary</a></li><li class="chapter-item expanded "><a href="../contributing/contributing.html"><strong aria-hidden="true">9.</strong> Contributing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../contributing/hacking.html"><strong aria-hidden="true">9.1.</strong> Hacking</a></li><li class="chapter-item expanded "><a href="../contributing/cli-guideline.html"><strong aria-hidden="true">9.2.</strong> CLI guideline</a></li></ol></li><li class="chapter-item expanded "><a href="../release-notes/release-notes.html"><strong aria-hidden="true">10.</strong> Release Notes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../release-notes/rl-2.12.html"><strong aria-hidden="true">10.1.</strong> Release 2.12 (2022-12-06)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.11.html"><strong aria-hidden="true">10.2.</strong> Release 2.11 (2022-08-25)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.10.html"><strong aria-hidden="true">10.3.</strong> Release 2.10 (2022-07-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.9.html"><strong aria-hidden="true">10.4.</strong> Release 2.9 (2022-05-30)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.8.html"><strong aria-hidden="true">10.5.</strong> Release 2.8 (2022-04-19)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.7.html"><strong aria-hidden="true">10.6.</strong> Release 2.7 (2022-03-07)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.6.html"><strong aria-hidden="true">10.7.</strong> Release 2.6 (2022-01-24)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.5.html"><strong aria-hidden="true">10.8.</strong> Release 2.5 (2021-12-13)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.4.html"><strong aria-hidden="true">10.9.</strong> Release 2.4 (2021-11-01)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.3.html"><strong aria-hidden="true">10.10.</strong> Release 2.3 (2019-09-04)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.2.html"><strong aria-hidden="true">10.11.</strong> Release 2.2 (2019-01-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.1.html"><strong aria-hidden="true">10.12.</strong> Release 2.1 (2018-09-02)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-2.0.html"><strong aria-hidden="true">10.13.</strong> Release 2.0 (2018-02-22)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.11.10.html"><strong aria-hidden="true">10.14.</strong> Release 1.11.10 (2017-06-12)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.11.html"><strong aria-hidden="true">10.15.</strong> Release 1.11 (2016-01-19)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.10.html"><strong aria-hidden="true">10.16.</strong> Release 1.10 (2015-09-03)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.9.html"><strong aria-hidden="true">10.17.</strong> Release 1.9 (2015-06-12)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.8.html"><strong aria-hidden="true">10.18.</strong> Release 1.8 (2014-12-14)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.7.html"><strong aria-hidden="true">10.19.</strong> Release 1.7 (2014-04-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.6.1.html"><strong aria-hidden="true">10.20.</strong> Release 1.6.1 (2013-10-28)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.6.html"><strong aria-hidden="true">10.21.</strong> Release 1.6 (2013-09-10)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.5.2.html"><strong aria-hidden="true">10.22.</strong> Release 1.5.2 (2013-05-13)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.5.html"><strong aria-hidden="true">10.23.</strong> Release 1.5 (2013-02-27)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.4.html"><strong aria-hidden="true">10.24.</strong> Release 1.4 (2013-02-26)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.3.html"><strong aria-hidden="true">10.25.</strong> Release 1.3 (2013-01-04)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.2.html"><strong aria-hidden="true">10.26.</strong> Release 1.2 (2012-12-06)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.1.html"><strong aria-hidden="true">10.27.</strong> Release 1.1 (2012-07-18)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-1.0.html"><strong aria-hidden="true">10.28.</strong> Release 1.0 (2012-05-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.16.html"><strong aria-hidden="true">10.29.</strong> Release 0.16 (2010-08-17)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.15.html"><strong aria-hidden="true">10.30.</strong> Release 0.15 (2010-03-17)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.14.html"><strong aria-hidden="true">10.31.</strong> Release 0.14 (2010-02-04)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.13.html"><strong aria-hidden="true">10.32.</strong> Release 0.13 (2009-11-05)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.12.html"><strong aria-hidden="true">10.33.</strong> Release 0.12 (2008-11-20)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.11.html"><strong aria-hidden="true">10.34.</strong> Release 0.11 (2007-12-31)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.10.1.html"><strong aria-hidden="true">10.35.</strong> Release 0.10.1 (2006-10-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.10.html"><strong aria-hidden="true">10.36.</strong> Release 0.10 (2006-10-06)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.9.2.html"><strong aria-hidden="true">10.37.</strong> Release 0.9.2 (2005-09-21)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.9.1.html"><strong aria-hidden="true">10.38.</strong> Release 0.9.1 (2005-09-20)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.9.html"><strong aria-hidden="true">10.39.</strong> Release 0.9 (2005-09-16)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.8.1.html"><strong aria-hidden="true">10.40.</strong> Release 0.8.1 (2005-04-13)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.8.html"><strong aria-hidden="true">10.41.</strong> Release 0.8 (2005-04-11)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.7.html"><strong aria-hidden="true">10.42.</strong> Release 0.7 (2005-01-12)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.6.html"><strong aria-hidden="true">10.43.</strong> Release 0.6 (2004-11-14)</a></li><li class="chapter-item expanded "><a href="../release-notes/rl-0.5.html"><strong aria-hidden="true">10.44.</strong> Release 0.5 and earlier</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="name"><a class="header" href="#name">Name</a></h1>
<p><code>nix.conf</code> - Nix configuration file</p>
<h1 id="description"><a class="header" href="#description">Description</a></h1>
<p>By default Nix reads settings from the following places:</p>
<ul>
<li>
<p>The system-wide configuration file <code>sysconfdir/nix/nix.conf</code> (i.e.
<code>/etc/nix/nix.conf</code> on most systems), or <code>$NIX_CONF_DIR/nix.conf</code> if
<code>NIX_CONF_DIR</code> is set. Values loaded in this file are not forwarded
to the Nix daemon. The client assumes that the daemon has already
loaded them.</p>
</li>
<li>
<p>If <code>NIX_USER_CONF_FILES</code> is set, then each path separated by <code>:</code>
will be loaded in reverse order.</p>
<p>Otherwise it will look for <code>nix/nix.conf</code> files in <code>XDG_CONFIG_DIRS</code>
and <code>XDG_CONFIG_HOME</code>. If unset, <code>XDG_CONFIG_DIRS</code> defaults to
<code>/etc/xdg</code>, and <code>XDG_CONFIG_HOME</code> defaults to <code>$HOME/.config</code>
as per <a href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html">XDG Base Directory Specification</a>.</p>
</li>
<li>
<p>If <code>NIX_CONFIG</code> is set, its contents is treated as the contents of
a configuration file.</p>
</li>
</ul>
<p>The configuration files consist of <code>name = value</code> pairs, one per
line. Other files can be included with a line like <code>include path</code>,
where <em>path</em> is interpreted relative to the current conf file and a
missing file is an error unless <code>!include</code> is used instead. Comments
start with a <code>#</code> character. Here is an example configuration file:</p>
<pre><code>keep-outputs = true       # Nice for developers
keep-derivations = true   # Idem
</code></pre>
<p>You can override settings on the command line using the <code>--option</code>
flag, e.g. <code>--option keep-outputs false</code>. Every configuration setting
also has a corresponding command line flag, e.g. <code>--max-jobs 16</code>; for
Boolean settings, there are two flags to enable or disable the setting
(e.g. <code>--keep-failed</code> and <code>--no-keep-failed</code>).</p>
<p>A configuration setting usually overrides any previous value. However,
you can prefix the name of the setting by <code>extra-</code> to <em>append</em> to the
previous value. For instance,</p>
<pre><code>substituters = a b
extra-substituters = c d
</code></pre>
<p>defines the <code>substituters</code> setting to be <code>a b c d</code>. This is also
available as a command line flag (e.g. <code>--extra-substituters</code>).</p>
<p>The following settings are currently available:</p>
<ul>
<li>
<p><a href="#conf-accept-flake-config"><code>accept-flake-config</code></a><p id="conf-accept-flake-config"></p></p>
<p>Whether to accept nix configuration from a flake without prompting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-access-tokens"><code>access-tokens</code></a><p id="conf-access-tokens"></p></p>
<p>Access tokens used to access protected GitHub, GitLab, or
other locations requiring token-based authentication.</p>
<p>Access tokens are specified as a string made up of
space-separated <code>host=token</code> values.  The specific token
used is selected by matching the <code>host</code> portion against the
&quot;host&quot; specification of the input. The actual use of the
<code>token</code> value is determined by the type of resource being
accessed:</p>
<ul>
<li>
<p>Github: the token value is the OAUTH-TOKEN string obtained
as the Personal Access Token from the Github server (see
https://docs.github.com/en/developers/apps/building-oauth-apps/authorizing-oauth-apps).</p>
</li>
<li>
<p>Gitlab: the token value is either the OAuth2 token or the
Personal Access Token (these are different types tokens
for gitlab, see
https://docs.gitlab.com/12.10/ee/api/README.html#authentication).
The <code>token</code> value should be <code>type:tokenstring</code> where
<code>type</code> is either <code>OAuth2</code> or <code>PAT</code> to indicate which type
of token is being specified.</p>
</li>
</ul>
<p>Example <code>~/.config/nix/nix.conf</code>:</p>
<pre><code>access-tokens = github.com=23ac...b289 gitlab.mycompany.com=PAT:A123Bp_Cd..EfG gitlab.com=OAuth2:1jklw3jk
</code></pre>
<p>Example <code>~/code/flake.nix</code>:</p>
<pre><code class="language-nix">input.foo = {
  type = &quot;gitlab&quot;;
  host = &quot;gitlab.mycompany.com&quot;;
  owner = &quot;mycompany&quot;;
  repo = &quot;pro&quot;;
};
</code></pre>
<p>This example specifies three tokens, one each for accessing
github.com, gitlab.mycompany.com, and sourceforge.net.</p>
<p>The <code>input.foo</code> uses the &quot;gitlab&quot; fetcher, which might
requires specifying the token type along with the token
value.</p>
<p><strong>Default:</strong> <code>&quot;&quot;</code></p>
</li>
<li>
<p><a href="#conf-allow-dirty"><code>allow-dirty</code></a><p id="conf-allow-dirty"></p></p>
<p>Whether to allow dirty Git/Mercurial trees.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-allow-import-from-derivation"><code>allow-import-from-derivation</code></a><p id="conf-allow-import-from-derivation"></p></p>
<p>By default, Nix allows you to <code>import</code> from a derivation, allowing
building at evaluation time. With this option set to false, Nix will
throw an error when evaluating an expression that uses this feature,
allowing users to ensure their evaluation will not require any
builds to take place.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-allow-new-privileges"><code>allow-new-privileges</code></a><p id="conf-allow-new-privileges"></p></p>
<p>(Linux-specific.) By default, builders on Linux cannot acquire new
privileges by calling setuid/setgid programs or programs that have
file capabilities. For example, programs such as <code>sudo</code> or <code>ping</code>
will fail. (Note that in sandbox builds, no such programs are
available unless you bind-mount them into the sandbox via the
<code>sandbox-paths</code> option.) You can allow the use of such programs by
enabling this option. This is impure and usually undesirable, but
may be useful in certain scenarios (e.g. to spin up containers or
set up userspace network interfaces in tests).</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-allow-symlinked-store"><code>allow-symlinked-store</code></a><p id="conf-allow-symlinked-store"></p></p>
<p>If set to <code>true</code>, Nix will stop complaining if the store directory
(typically /nix/store) contains symlink components.</p>
<p>This risks making some builds &quot;impure&quot; because builders sometimes
&quot;canonicalise&quot; paths by resolving all symlink components. Problems
occur if those builds are then deployed to machines where /nix/store
resolves to a different location from that of the build machine. You
can enable this setting if you are sure you're not going to do that.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-allow-unsafe-native-code-during-evaluation"><code>allow-unsafe-native-code-during-evaluation</code></a><p id="conf-allow-unsafe-native-code-during-evaluation"></p></p>
<p>Whether builtin functions that allow executing native code should be enabled.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-allowed-impure-host-deps"><code>allowed-impure-host-deps</code></a><p id="conf-allowed-impure-host-deps"></p></p>
<p>Which prefixes to allow derivations to ask for access to (primarily for Darwin).</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-allowed-uris"><code>allowed-uris</code></a><p id="conf-allowed-uris"></p></p>
<p>A list of URI prefixes to which access is allowed in restricted
evaluation mode. For example, when set to
<code>https://github.com/NixOS</code>, builtin functions such as <code>fetchGit</code> are
allowed to access <code>https://github.com/NixOS/patchelf.git</code>.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-allowed-users"><code>allowed-users</code></a><p id="conf-allowed-users"></p></p>
<p>A list of names of users (separated by whitespace) that are allowed
to connect to the Nix daemon. As with the <code>trusted-users</code> option,
you can specify groups by prefixing them with <code>@</code>. Also, you can
allow all users by specifying <code>*</code>. The default is <code>*</code>.</p>
<p>Note that trusted users are always allowed to connect.</p>
<p><strong>Default:</strong> <code>*</code></p>
</li>
<li>
<p><a href="#conf-auto-allocate-uids"><code>auto-allocate-uids</code></a><p id="conf-auto-allocate-uids"></p></p>
<p>Whether to select UIDs for builds automatically, instead of using the
users in <code>build-users-group</code>.</p>
<p>UIDs are allocated starting at 872415232 (0x34000000) on Linux and 56930 on macOS.</p>
<blockquote>
<p><strong>Warning</strong>
This is an experimental feature.</p>
</blockquote>
<p>To enable it, add the following to <a href="#"><code>nix.conf</code></a>:</p>
<pre><code>extra-experimental-features = auto-allocate-uids
auto-allocate-uids = true
</code></pre>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-auto-optimise-store"><code>auto-optimise-store</code></a><p id="conf-auto-optimise-store"></p></p>
<p>If set to <code>true</code>, Nix automatically detects files in the store
that have identical contents, and replaces them with hard links to
a single copy. This saves disk space. If set to <code>false</code> (the
default), you can still run <code>nix-store --optimise</code> to get rid of
duplicate files.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-bash-prompt"><code>bash-prompt</code></a><p id="conf-bash-prompt"></p></p>
<p>The bash prompt (<code>PS1</code>) in <code>nix develop</code> shells.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-bash-prompt-prefix"><code>bash-prompt-prefix</code></a><p id="conf-bash-prompt-prefix"></p></p>
<p>Prefix prepended to the <code>PS1</code> environment variable in <code>nix develop</code> shells.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-bash-prompt-suffix"><code>bash-prompt-suffix</code></a><p id="conf-bash-prompt-suffix"></p></p>
<p>Suffix appended to the <code>PS1</code> environment variable in <code>nix develop</code> shells.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-build-hook"><code>build-hook</code></a><p id="conf-build-hook"></p></p>
<p>The path of the helper program that executes builds to remote machines.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-build-poll-interval"><code>build-poll-interval</code></a><p id="conf-build-poll-interval"></p></p>
<p>How often (in seconds) to poll for locks.</p>
<p><strong>Default:</strong> <code>5</code></p>
</li>
<li>
<p><a href="#conf-build-users-group"><code>build-users-group</code></a><p id="conf-build-users-group"></p></p>
<p>This options specifies the Unix group containing the Nix build user
accounts. In multi-user Nix installations, builds should not be
performed by the Nix account since that would allow users to
arbitrarily modify the Nix store and database by supplying specially
crafted builders; and they cannot be performed by the calling user
since that would allow him/her to influence the build result.</p>
<p>Therefore, if this option is non-empty and specifies a valid group,
builds will be performed under the user accounts that are a member
of the group specified here (as listed in <code>/etc/group</code>). Those user
accounts should not be used for any other purpose!</p>
<p>Nix will never run two builds under the same user account at the
same time. This is to prevent an obvious security hole: a malicious
user writing a Nix expression that modifies the build result of a
legitimate Nix expression being built by another user. Therefore it
is good to have as many Nix build user accounts as you can spare.
(Remember: uids are cheap.)</p>
<p>The build users should have permission to create files in the Nix
store, but not delete them. Therefore, <code>/nix/store</code> should be owned
by the Nix account, its group should be the group specified here,
and its mode should be <code>1775</code>.</p>
<p>If the build users group is empty, builds will be performed under
the uid of the Nix process (that is, the uid of the caller if
<code>NIX_REMOTE</code> is empty, the uid under which the Nix daemon runs if
<code>NIX_REMOTE</code> is <code>daemon</code>). Obviously, this should not be used in
multi-user settings with untrusted users.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-builders"><code>builders</code></a><p id="conf-builders"></p></p>
<p>A semicolon-separated list of build machines.
For the exact format and examples, see <a href="../advanced-topics/distributed-builds.html">the manual chapter on remote builds</a></p>
<p><strong>Default:</strong> <code>@/dummy/machines</code></p>
</li>
<li>
<p><a href="#conf-builders-use-substitutes"><code>builders-use-substitutes</code></a><p id="conf-builders-use-substitutes"></p></p>
<p>If set to <code>true</code>, Nix will instruct remote build machines to use
their own binary substitutes if available. In practical terms, this
means that remote hosts will fetch as many build dependencies as
possible from their own substitutes (e.g, from <code>cache.nixos.org</code>),
instead of waiting for this host to upload them all. This can
drastically reduce build times if the network connection between
this computer and the remote build host is slow.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-commit-lockfile-summary"><code>commit-lockfile-summary</code></a><p id="conf-commit-lockfile-summary"></p></p>
<p>The commit summary to use when committing changed flake lock files. If
empty, the summary is generated based on the action performed.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-compress-build-log"><code>compress-build-log</code></a><p id="conf-compress-build-log"></p></p>
<p>If set to <code>true</code> (the default), build logs written to
<code>/nix/var/log/nix/drvs</code> will be compressed on the fly using bzip2.
Otherwise, they will not be compressed.</p>
<p><strong>Default:</strong> <code>true</code></p>
<p><strong>Deprecated alias:</strong> <code>build-compress-log</code></p>
</li>
<li>
<p><a href="#conf-connect-timeout"><code>connect-timeout</code></a><p id="conf-connect-timeout"></p></p>
<p>The timeout (in seconds) for establishing connections in the
binary cache substituter. It corresponds to <code>curl</code>s
<code>--connect-timeout</code> option. A value of 0 means no limit.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><a href="#conf-cores"><code>cores</code></a><p id="conf-cores"></p></p>
<p>Sets the value of the <code>NIX_BUILD_CORES</code> environment variable in the
invocation of builders. Builders can use this variable at their
discretion to control the maximum amount of parallelism. For
instance, in Nixpkgs, if the derivation attribute
<code>enableParallelBuilding</code> is set to <code>true</code>, the builder passes the
<code>-jN</code> flag to GNU Make. It can be overridden using the <code>--cores</code>
command line switch and defaults to <code>1</code>. The value <code>0</code> means that
the builder should use all available CPU cores in the system.</p>
<p><strong>Default:</strong> <em>machine-specific</em>
<strong>Deprecated alias:</strong> <code>build-cores</code></p>
</li>
<li>
<p><a href="#conf-diff-hook"><code>diff-hook</code></a><p id="conf-diff-hook"></p></p>
<p>Absolute path to an executable capable of diffing build
results. The hook is executed if <code>run-diff-hook</code> is true, and the
output of a build is known to not be the same. This program is not
executed to determine if two results are the same.</p>
<p>The diff hook is executed by the same user and group who ran the
build. However, the diff hook does not have write access to the
store path just built.</p>
<p>The diff hook program receives three parameters:</p>
<ol>
<li>
<p>A path to the previous build's results</p>
</li>
<li>
<p>A path to the current build's results</p>
</li>
<li>
<p>The path to the build's derivation</p>
</li>
<li>
<p>The path to the build's scratch directory. This directory will
exist only if the build was run with <code>--keep-failed</code>.</p>
</li>
</ol>
<p>The stderr and stdout output from the diff hook will not be
displayed to the user. Instead, it will print to the nix-daemon's
log.</p>
<p>When using the Nix daemon, <code>diff-hook</code> must be set in the <code>nix.conf</code>
configuration file, and cannot be passed at the command line.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-download-attempts"><code>download-attempts</code></a><p id="conf-download-attempts"></p></p>
<p>How often Nix will attempt to download a file before giving up.</p>
<p><strong>Default:</strong> <code>5</code></p>
</li>
<li>
<p><a href="#conf-download-speed"><code>download-speed</code></a><p id="conf-download-speed"></p></p>
<p>Specify the maximum transfer rate in kilobytes per second you want
Nix to use for downloads.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><a href="#conf-enforce-determinism"><code>enforce-determinism</code></a><p id="conf-enforce-determinism"></p></p>
<p>Whether to fail if repeated builds produce different output. See <code>repeat</code>.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-eval-cache"><code>eval-cache</code></a><p id="conf-eval-cache"></p></p>
<p>Whether to use the flake evaluation cache.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-experimental-features"><code>experimental-features</code></a><p id="conf-experimental-features"></p></p>
<p>Experimental Nix features to enable.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-extra-platforms"><code>extra-platforms</code></a><p id="conf-extra-platforms"></p></p>
<p>Platforms other than the native one which this machine is capable of
building for. This can be useful for supporting additional
architectures on compatible machines: i686-linux can be built on
x86_64-linux machines (and the default for this setting reflects
this); armv7 is backwards-compatible with armv6 and armv5tel; some
aarch64 machines can also natively run 32-bit ARM code; and
qemu-user may be used to support non-native platforms (though this
may be slow and buggy). Most values for this are not enabled by
default because build systems will often misdetect the target
platform and generate incompatible code, so you may wish to
cross-check the results of using this option against proper
natively-built versions of your derivations.</p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><a href="#conf-fallback"><code>fallback</code></a><p id="conf-fallback"></p></p>
<p>If set to <code>true</code>, Nix will fall back to building from source if a
binary substitute fails. This is equivalent to the <code>--fallback</code>
flag. The default is <code>false</code>.</p>
<p><strong>Default:</strong> <code>false</code></p>
<p><strong>Deprecated alias:</strong> <code>build-fallback</code></p>
</li>
<li>
<p><a href="#conf-filter-syscalls"><code>filter-syscalls</code></a><p id="conf-filter-syscalls"></p></p>
<p>Whether to prevent certain dangerous system calls, such as
creation of setuid/setgid files or adding ACLs or extended
attributes. Only disable this if you're aware of the
security implications.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-flake-registry"><code>flake-registry</code></a><p id="conf-flake-registry"></p></p>
<p>Path or URI of the global flake registry.</p>
<p><strong>Default:</strong> <code>https://channels.nixos.org/flake-registry.json</code></p>
</li>
<li>
<p><a href="#conf-fsync-metadata"><code>fsync-metadata</code></a><p id="conf-fsync-metadata"></p></p>
<p>If set to <code>true</code>, changes to the Nix store metadata (in
<code>/nix/var/nix/db</code>) are synchronously flushed to disk. This improves
robustness in case of system crashes, but reduces performance. The
default is <code>true</code>.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-gc-reserved-space"><code>gc-reserved-space</code></a><p id="conf-gc-reserved-space"></p></p>
<p>Amount of reserved disk space for the garbage collector.</p>
<p><strong>Default:</strong> <code>8388608</code></p>
</li>
<li>
<p><a href="#conf-hashed-mirrors"><code>hashed-mirrors</code></a><p id="conf-hashed-mirrors"></p></p>
<p>A list of web servers used by <code>builtins.fetchurl</code> to obtain files by
hash. The default is <code>http://tarballs.nixos.org/</code>. Given a hash type
<em>ht</em> and a base-16 hash <em>h</em>, Nix will try to download the file from
<em>hashed-mirror</em>/<em>ht</em>/<em>h</em>. This allows files to be downloaded even if
they have disappeared from their original URI. For example, given
the default mirror <code>http://tarballs.nixos.org/</code>, when building the
derivation</p>
<pre><code class="language-nix">builtins.fetchurl {
  url = &quot;https://example.org/foo-1.2.3.tar.xz&quot;;
  sha256 = &quot;2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae&quot;;
}
</code></pre>
<p>Nix will attempt to download this file from
<code>http://tarballs.nixos.org/sha256/2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae</code>
first. If it is not available there, if will try the original URI.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-http-connections"><code>http-connections</code></a><p id="conf-http-connections"></p></p>
<p>The maximum number of parallel TCP connections used to fetch
files from binary caches and by other downloads. It defaults
to 25. 0 means no limit.</p>
<p><strong>Default:</strong> <code>25</code></p>
<p><strong>Deprecated alias:</strong> <code>binary-caches-parallel-connections</code></p>
</li>
<li>
<p><a href="#conf-http2"><code>http2</code></a><p id="conf-http2"></p></p>
<p>Whether to enable HTTP/2 support.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-id-count"><code>id-count</code></a><p id="conf-id-count"></p></p>
<p>The number of UIDs/GIDs to use for dynamic ID allocation.</p>
<p><strong>Default:</strong> <code>8388608</code></p>
</li>
<li>
<p><a href="#conf-ignore-try"><code>ignore-try</code></a><p id="conf-ignore-try"></p></p>
<p>If set to true, ignore exceptions inside 'tryEval' calls when evaluating nix expressions in
debug mode (using the --debugger flag). By default the debugger will pause on all exceptions.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-ignored-acls"><code>ignored-acls</code></a><p id="conf-ignored-acls"></p></p>
<p>A list of ACLs that should be ignored, normally Nix attempts to
remove all ACLs from files and directories in the Nix store, but
some ACLs like <code>security.selinux</code> or <code>system.nfs4_acl</code> can't be
removed even by root. Therefore it's best to just ignore them.</p>
<p><strong>Default:</strong> <code>security.csm security.selinux system.nfs4_acl</code></p>
</li>
<li>
<p><a href="#conf-impersonate-linux-26"><code>impersonate-linux-26</code></a><p id="conf-impersonate-linux-26"></p></p>
<p>Whether to impersonate a Linux 2.6 machine on newer kernels.</p>
<p><strong>Default:</strong> <code>false</code></p>
<p><strong>Deprecated alias:</strong> <code>build-impersonate-linux-26</code></p>
</li>
<li>
<p><a href="#conf-keep-build-log"><code>keep-build-log</code></a><p id="conf-keep-build-log"></p></p>
<p>If set to <code>true</code> (the default), Nix will write the build log of a
derivation (i.e. the standard output and error of its builder) to
the directory <code>/nix/var/log/nix/drvs</code>. The build log can be
retrieved using the command <code>nix-store -l path</code>.</p>
<p><strong>Default:</strong> <code>true</code></p>
<p><strong>Deprecated alias:</strong> <code>build-keep-log</code></p>
</li>
<li>
<p><a href="#conf-keep-derivations"><code>keep-derivations</code></a><p id="conf-keep-derivations"></p></p>
<p>If <code>true</code> (default), the garbage collector will keep the derivations
from which non-garbage store paths were built. If <code>false</code>, they will
be deleted unless explicitly registered as a root (or reachable from
other roots).</p>
<p>Keeping derivation around is useful for querying and traceability
(e.g., it allows you to ask with what dependencies or options a
store path was built), so by default this option is on. Turn it off
to save a bit of disk space (or a lot if <code>keep-outputs</code> is also
turned on).</p>
<p><strong>Default:</strong> <code>true</code></p>
<p><strong>Deprecated alias:</strong> <code>gc-keep-derivations</code></p>
</li>
<li>
<p><a href="#conf-keep-env-derivations"><code>keep-env-derivations</code></a><p id="conf-keep-env-derivations"></p></p>
<p>If <code>false</code> (default), derivations are not stored in Nix user
environments. That is, the derivations of any build-time-only
dependencies may be garbage-collected.</p>
<p>If <code>true</code>, when you add a Nix derivation to a user environment, the
path of the derivation is stored in the user environment. Thus, the
derivation will not be garbage-collected until the user environment
generation is deleted (<code>nix-env --delete-generations</code>). To prevent
build-time-only dependencies from being collected, you should also
turn on <code>keep-outputs</code>.</p>
<p>The difference between this option and <code>keep-derivations</code> is that
this one is sticky: it applies to any user environment created
while this option was enabled, while <code>keep-derivations</code> only applies
at the moment the garbage collector is run.</p>
<p><strong>Default:</strong> <code>false</code></p>
<p><strong>Deprecated alias:</strong> <code>env-keep-derivations</code></p>
</li>
<li>
<p><a href="#conf-keep-failed"><code>keep-failed</code></a><p id="conf-keep-failed"></p></p>
<p>Whether to keep temporary directories of failed builds.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-keep-going"><code>keep-going</code></a><p id="conf-keep-going"></p></p>
<p>Whether to keep building derivations when another build fails.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-keep-outputs"><code>keep-outputs</code></a><p id="conf-keep-outputs"></p></p>
<p>If <code>true</code>, the garbage collector will keep the outputs of
non-garbage derivations. If <code>false</code> (default), outputs will be
deleted unless they are GC roots themselves (or reachable from other
roots).</p>
<p>In general, outputs must be registered as roots separately. However,
even if the output of a derivation is registered as a root, the
collector will still delete store paths that are used only at build
time (e.g., the C compiler, or source tarballs downloaded from the
network). To prevent it from doing so, set this option to <code>true</code>.</p>
<p><strong>Default:</strong> <code>false</code></p>
<p><strong>Deprecated alias:</strong> <code>gc-keep-outputs</code></p>
</li>
<li>
<p><a href="#conf-log-lines"><code>log-lines</code></a><p id="conf-log-lines"></p></p>
<p>The number of lines of the tail of the log to show if a build fails.</p>
<p><strong>Default:</strong> <code>10</code></p>
</li>
<li>
<p><a href="#conf-max-build-log-size"><code>max-build-log-size</code></a><p id="conf-max-build-log-size"></p></p>
<p>This option defines the maximum number of bytes that a builder can
write to its stdout/stderr. If the builder exceeds this limit, its
killed. A value of <code>0</code> (the default) means that there is no limit.</p>
<p><strong>Default:</strong> <code>0</code></p>
<p><strong>Deprecated alias:</strong> <code>build-max-log-size</code></p>
</li>
<li>
<p><a href="#conf-max-free"><code>max-free</code></a><p id="conf-max-free"></p></p>
<p>When a garbage collection is triggered by the <code>min-free</code> option, it
stops as soon as <code>max-free</code> bytes are available. The default is
infinity (i.e. delete all garbage).</p>
<p><strong>Default:</strong> <code>-1</code></p>
</li>
<li>
<p><a href="#conf-max-jobs"><code>max-jobs</code></a><p id="conf-max-jobs"></p></p>
<p>This option defines the maximum number of jobs that Nix will try to
build in parallel. The default is <code>1</code>. The special value <code>auto</code>
causes Nix to use the number of CPUs in your system. <code>0</code> is useful
when using remote builders to prevent any local builds (except for
<code>preferLocalBuild</code> derivation attribute which executes locally
regardless). It can be overridden using the <code>--max-jobs</code> (<code>-j</code>)
command line switch.</p>
<p><strong>Default:</strong> <code>1</code></p>
<p><strong>Deprecated alias:</strong> <code>build-max-jobs</code></p>
</li>
<li>
<p><a href="#conf-max-silent-time"><code>max-silent-time</code></a><p id="conf-max-silent-time"></p></p>
<p>This option defines the maximum number of seconds that a builder can
go without producing any data on standard output or standard error.
This is useful (for instance in an automated build system) to catch
builds that are stuck in an infinite loop, or to catch remote builds
that are hanging due to network problems. It can be overridden using
the <code>--max-silent-time</code> command line switch.</p>
<p>The value <code>0</code> means that there is no timeout. This is also the
default.</p>
<p><strong>Default:</strong> <code>0</code></p>
<p><strong>Deprecated alias:</strong> <code>build-max-silent-time</code></p>
</li>
<li>
<p><a href="#conf-min-free"><code>min-free</code></a><p id="conf-min-free"></p></p>
<p>When free disk space in <code>/nix/store</code> drops below <code>min-free</code> during a
build, Nix performs a garbage-collection until <code>max-free</code> bytes are
available or there is no more garbage. A value of <code>0</code> (the default)
disables this feature.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><a href="#conf-min-free-check-interval"><code>min-free-check-interval</code></a><p id="conf-min-free-check-interval"></p></p>
<p>Number of seconds between checking free disk space.</p>
<p><strong>Default:</strong> <code>5</code></p>
</li>
<li>
<p><a href="#conf-nar-buffer-size"><code>nar-buffer-size</code></a><p id="conf-nar-buffer-size"></p></p>
<p>Maximum size of NARs before spilling them to disk.</p>
<p><strong>Default:</strong> <code>33554432</code></p>
</li>
<li>
<p><a href="#conf-narinfo-cache-negative-ttl"><code>narinfo-cache-negative-ttl</code></a><p id="conf-narinfo-cache-negative-ttl"></p></p>
<p>The TTL in seconds for negative lookups. If a store path is queried
from a substituter but was not found, there will be a negative
lookup cached in the local disk cache database for the specified
duration.</p>
<p><strong>Default:</strong> <code>3600</code></p>
</li>
<li>
<p><a href="#conf-narinfo-cache-positive-ttl"><code>narinfo-cache-positive-ttl</code></a><p id="conf-narinfo-cache-positive-ttl"></p></p>
<p>The TTL in seconds for positive lookups. If a store path is queried
from a substituter, the result of the query will be cached in the
local disk cache database including some of the NAR metadata. The
default TTL is a month, setting a shorter TTL for positive lookups
can be useful for binary caches that have frequent garbage
collection, in which case having a more frequent cache invalidation
would prevent trying to pull the path again and failing with a hash
mismatch if the build isn't reproducible.</p>
<p><strong>Default:</strong> <code>2592000</code></p>
</li>
<li>
<p><a href="#conf-netrc-file"><code>netrc-file</code></a><p id="conf-netrc-file"></p></p>
<p>If set to an absolute path to a <code>netrc</code> file, Nix will use the HTTP
authentication credentials in this file when trying to download from
a remote host through HTTP or HTTPS. Defaults to
<code>$NIX_CONF_DIR/netrc</code>.</p>
<p>The <code>netrc</code> file consists of a list of accounts in the following
format:</p>
<pre><code>machine my-machine
login my-username
password my-password
</code></pre>
<p>For the exact syntax, see <a href="https://ec.haxx.se/usingcurl-netrc.html">the <code>curl</code>
documentation</a>.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>This must be an absolute path, and <code>~</code> is not resolved. For
example, <code>~/.netrc</code> won't resolve to your home directory's
<code>.netrc</code>.</p>
</blockquote>
<p><strong>Default:</strong> <code>/dummy/netrc</code></p>
</li>
<li>
<p><a href="#conf-nix-path"><code>nix-path</code></a><p id="conf-nix-path"></p></p>
<p>List of directories to be searched for <code>&lt;...&gt;</code> file references.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-plugin-files"><code>plugin-files</code></a><p id="conf-plugin-files"></p></p>
<p>A list of plugin files to be loaded by Nix. Each of these files will
be dlopened by Nix, allowing them to affect execution through static
initialization. In particular, these plugins may construct static
instances of RegisterPrimOp to add new primops or constants to the
expression language, RegisterStoreImplementation to add new store
implementations, RegisterCommand to add new subcommands to the <code>nix</code>
command, and RegisterSetting to add new nix config settings. See the
constructors for those types for more details.</p>
<p>Warning! These APIs are inherently unstable and may change from
release to release.</p>
<p>Since these files are loaded into the same address space as Nix
itself, they must be DSOs compatible with the instance of Nix
running at the time (i.e. compiled against the same headers, not
linked to any incompatible libraries). They should not be linked to
any Nix libs directly, as those will be available already at load
time.</p>
<p>If an entry in the list is a directory, all files in the directory
are loaded as plugins (non-recursively).</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-post-build-hook"><code>post-build-hook</code></a><p id="conf-post-build-hook"></p></p>
<p>Optional. The path to a program to execute after each build.</p>
<p>This option is only settable in the global <code>nix.conf</code>, or on the
command line by trusted users.</p>
<p>When using the nix-daemon, the daemon executes the hook as <code>root</code>.
If the nix-daemon is not involved, the hook runs as the user
executing the nix-build.</p>
<ul>
<li>
<p>The hook executes after an evaluation-time build.</p>
</li>
<li>
<p>The hook does not execute on substituted paths.</p>
</li>
<li>
<p>The hook's output always goes to the user's terminal.</p>
</li>
<li>
<p>If the hook fails, the build succeeds but no further builds
execute.</p>
</li>
<li>
<p>The hook executes synchronously, and blocks other builds from
progressing while it runs.</p>
</li>
</ul>
<p>The program executes with no arguments. The program's environment
contains the following environment variables:</p>
<ul>
<li>
<p><code>DRV_PATH</code>
The derivation for the built paths.</p>
<p>Example:
<code>/nix/store/5nihn1a7pa8b25l9zafqaqibznlvvp3f-bash-4.4-p23.drv</code></p>
</li>
<li>
<p><code>OUT_PATHS</code>
Output paths of the built derivation, separated by a space
character.</p>
<p>Example:
<code>/nix/store/zf5lbh336mnzf1nlswdn11g4n2m8zh3g-bash-4.4-p23-dev /nix/store/rjxwxwv1fpn9wa2x5ssk5phzwlcv4mna-bash-4.4-p23-doc /nix/store/6bqvbzjkcp9695dq0dpl5y43nvy37pq1-bash-4.4-p23-info /nix/store/r7fng3kk3vlpdlh2idnrbn37vh4imlj2-bash-4.4-p23-man /nix/store/xfghy8ixrhz3kyy6p724iv3cxji088dx-bash-4.4-p23</code>.</p>
</li>
</ul>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-pre-build-hook"><code>pre-build-hook</code></a><p id="conf-pre-build-hook"></p></p>
<p>If set, the path to a program that can set extra derivation-specific
settings for this system. This is used for settings that can't be
captured by the derivation model itself and are too variable between
different versions of the same system to be hard-coded into nix.</p>
<p>The hook is passed the derivation path and, if sandboxes are
enabled, the sandbox directory. It can then modify the sandbox and
send a series of commands to modify various settings to stdout. The
currently recognized commands are:</p>
<ul>
<li><code>extra-sandbox-paths</code><br />
Pass a list of files and directories to be included in the
sandbox for this build. One entry per line, terminated by an
empty line. Entries have the same format as <code>sandbox-paths</code>.</li>
</ul>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-preallocate-contents"><code>preallocate-contents</code></a><p id="conf-preallocate-contents"></p></p>
<p>Whether to preallocate files when writing objects with known size.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-print-missing"><code>print-missing</code></a><p id="conf-print-missing"></p></p>
<p>Whether to print what paths need to be built or downloaded.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-pure-eval"><code>pure-eval</code></a><p id="conf-pure-eval"></p></p>
<p>Whether to restrict file system and network access to files specified by cryptographic hash.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-repeat"><code>repeat</code></a><p id="conf-repeat"></p></p>
<p>How many times to repeat builds to check whether they are
deterministic. The default value is 0. If the value is non-zero,
every build is repeated the specified number of times. If the
contents of any of the runs differs from the previous ones and
<code>enforce-determinism</code> is true, the build is rejected and the
resulting store paths are not registered as valid in Nixs
database.</p>
<p><strong>Default:</strong> <code>0</code></p>
<p><strong>Deprecated alias:</strong> <code>build-repeat</code></p>
</li>
<li>
<p><a href="#conf-require-sigs"><code>require-sigs</code></a><p id="conf-require-sigs"></p></p>
<p>If set to <code>true</code> (the default), any non-content-addressed path added
or copied to the Nix store (e.g. when substituting from a binary
cache) must have a signature by a trusted key. A trusted key is one
listed in <code>trusted-public-keys</code>, or a public key counterpart to a
private key stored in a file listed in <code>secret-key-files</code>.</p>
<p>Set to <code>false</code> to disable signature checking and trust all
non-content-addressed paths unconditionally.</p>
<p>(Content-addressed paths are inherently trustworthy and thus
unaffected by this configuration option.)</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-restrict-eval"><code>restrict-eval</code></a><p id="conf-restrict-eval"></p></p>
<p>If set to <code>true</code>, the Nix evaluator will not allow access to any
files outside of the Nix search path (as set via the <code>NIX_PATH</code>
environment variable or the <code>-I</code> option), or to URIs outside of
<code>allowed-uri</code>. The default is <code>false</code>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-run-diff-hook"><code>run-diff-hook</code></a><p id="conf-run-diff-hook"></p></p>
<p>If true, enable the execution of the <code>diff-hook</code> program.</p>
<p>When using the Nix daemon, <code>run-diff-hook</code> must be set in the
<code>nix.conf</code> configuration file, and cannot be passed at the command
line.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-sandbox"><code>sandbox</code></a><p id="conf-sandbox"></p></p>
<p>If set to <code>true</code>, builds will be performed in a <em>sandboxed
environment</em>, i.e., theyre isolated from the normal file system
hierarchy and will only see their dependencies in the Nix store,
the temporary build directory, private versions of <code>/proc</code>,
<code>/dev</code>, <code>/dev/shm</code> and <code>/dev/pts</code> (on Linux), and the paths
configured with the <code>sandbox-paths</code> option. This is useful to
prevent undeclared dependencies on files in directories such as
<code>/usr/bin</code>. In addition, on Linux, builds run in private PID,
mount, network, IPC and UTS namespaces to isolate them from other
processes in the system (except that fixed-output derivations do
not run in private network namespace to ensure they can access the
network).</p>
<p>Currently, sandboxing only work on Linux and macOS. The use of a
sandbox requires that Nix is run as root (so you should use the
build users feature to perform the actual builds under different
users than root).</p>
<p>If this option is set to <code>relaxed</code>, then fixed-output derivations
and derivations that have the <code>__noChroot</code> attribute set to <code>true</code>
do not run in sandboxes.</p>
<p>The default is <code>true</code> on Linux and <code>false</code> on all other platforms.</p>
<p><strong>Default:</strong> <code>true</code></p>
<p><strong>Deprecated alias:</strong> <code>build-use-chroot</code>, <code>build-use-sandbox</code></p>
</li>
<li>
<p><a href="#conf-sandbox-build-dir"><code>sandbox-build-dir</code></a><p id="conf-sandbox-build-dir"></p></p>
<p>The build directory inside the sandbox.</p>
<p><strong>Default:</strong> <code>/build</code></p>
</li>
<li>
<p><a href="#conf-sandbox-dev-shm-size"><code>sandbox-dev-shm-size</code></a><p id="conf-sandbox-dev-shm-size"></p></p>
<p>This option determines the maximum size of the <code>tmpfs</code> filesystem
mounted on <code>/dev/shm</code> in Linux sandboxes. For the format, see the
description of the <code>size</code> option of <code>tmpfs</code> in mount8. The default
is <code>50%</code>.</p>
<p><strong>Default:</strong> <code>50%</code></p>
</li>
<li>
<p><a href="#conf-sandbox-fallback"><code>sandbox-fallback</code></a><p id="conf-sandbox-fallback"></p></p>
<p>Whether to disable sandboxing when the kernel doesn't allow it.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-sandbox-paths"><code>sandbox-paths</code></a><p id="conf-sandbox-paths"></p></p>
<p>A list of paths bind-mounted into Nix sandbox environments. You can
use the syntax <code>target=source</code> to mount a path in a different
location in the sandbox; for instance, <code>/bin=/nix-bin</code> will mount
the path <code>/nix-bin</code> as <code>/bin</code> inside the sandbox. If <em>source</em> is
followed by <code>?</code>, then it is not an error if <em>source</em> does not exist;
for example, <code>/dev/nvidiactl?</code> specifies that <code>/dev/nvidiactl</code> will
only be mounted in the sandbox if it exists in the host filesystem.</p>
<p>Depending on how Nix was built, the default value for this option
may be empty or provide <code>/bin/sh</code> as a bind-mount of <code>bash</code>.</p>
<p><strong>Default:</strong> <em>empty</em></p>
<p><strong>Deprecated alias:</strong> <code>build-chroot-dirs</code>, <code>build-sandbox-paths</code></p>
</li>
<li>
<p><a href="#conf-secret-key-files"><code>secret-key-files</code></a><p id="conf-secret-key-files"></p></p>
<p>A whitespace-separated list of files containing secret (private)
keys. These are used to sign locally-built paths. They can be
generated using <code>nix-store --generate-binary-cache-key</code>. The
corresponding public key can be distributed to other users, who
can add it to <code>trusted-public-keys</code> in their <code>nix.conf</code>.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-show-trace"><code>show-trace</code></a><p id="conf-show-trace"></p></p>
<p>Whether Nix should print out a stack trace in case of Nix
expression evaluation errors.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-stalled-download-timeout"><code>stalled-download-timeout</code></a><p id="conf-stalled-download-timeout"></p></p>
<p>The timeout (in seconds) for receiving data from servers
during download. Nix cancels idle downloads after this
timeout's duration.</p>
<p><strong>Default:</strong> <code>300</code></p>
</li>
<li>
<p><a href="#conf-start-id"><code>start-id</code></a><p id="conf-start-id"></p></p>
<p>The first UID and GID to use for dynamic ID allocation.</p>
<p><strong>Default:</strong> <code>872415232</code></p>
</li>
<li>
<p><a href="#conf-store"><code>store</code></a><p id="conf-store"></p></p>
<p>The default Nix store to use.</p>
<p><strong>Default:</strong> <code>auto</code></p>
</li>
<li>
<p><a href="#conf-substitute"><code>substitute</code></a><p id="conf-substitute"></p></p>
<p>If set to <code>true</code> (default), Nix will use binary substitutes if
available. This option can be disabled to force building from
source.</p>
<p><strong>Default:</strong> <code>true</code></p>
<p><strong>Deprecated alias:</strong> <code>build-use-substitutes</code></p>
</li>
<li>
<p><a href="#conf-substituters"><code>substituters</code></a><p id="conf-substituters"></p></p>
<p>A list of URLs of substituters, separated by whitespace. Substituters
are tried based on their Priority value, which each substituter can set
independently. Lower value means higher priority.
The default is <code>https://cache.nixos.org</code>, with a Priority of 40.</p>
<p>Nix will copy a store path from a remote store only if one
of the following is true:</p>
<ul>
<li>the store object is signed by one of the <a href="#conf-trusted-public-keys"><code>trusted-public-keys</code></a></li>
<li>the substituter is in the <a href="#conf-trusted-substituters"><code>trusted-substituters</code></a> list</li>
<li>the <a href="#conf-require-sigs"><code>require-sigs</code></a> option has been set to <code>false</code></li>
<li>the store object is <a href="glossary.html#gloss-output-addressed-store-object">output-addressed</a></li>
</ul>
<p><strong>Default:</strong> <code>https://cache.nixos.org/</code></p>
<p><strong>Deprecated alias:</strong> <code>binary-caches</code></p>
</li>
<li>
<p><a href="#conf-sync-before-registering"><code>sync-before-registering</code></a><p id="conf-sync-before-registering"></p></p>
<p>Whether to call <code>sync()</code> before registering a path as valid.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-system"><code>system</code></a><p id="conf-system"></p></p>
<p>This option specifies the canonical Nix system name of the current
installation, such as <code>i686-linux</code> or <code>x86_64-darwin</code>. Nix can only
build derivations whose <code>system</code> attribute equals the value
specified here. In general, it never makes sense to modify this
value from its default, since you can use it to lie about the
platform you are building on (e.g., perform a Mac OS build on a
Linux machine; the result would obviously be wrong). It only makes
sense if the Nix binaries can run on multiple platforms, e.g.,
universal binaries that run on <code>x86_64-linux</code> and <code>i686-linux</code>.</p>
<p>It defaults to the canonical Nix system name detected by <code>configure</code>
at build time.</p>
<p><strong>Default:</strong> <code>x86_64-linux</code></p>
</li>
<li>
<p><a href="#conf-system-features"><code>system-features</code></a><p id="conf-system-features"></p></p>
<p>A set of system features supported by this machine, e.g. <code>kvm</code>.
Derivations can express a dependency on such features through the
derivation attribute <code>requiredSystemFeatures</code>. For example, the
attribute</p>
<pre><code>requiredSystemFeatures = [ &quot;kvm&quot; ];
</code></pre>
<p>ensures that the derivation can only be built on a machine with the
<code>kvm</code> feature.</p>
<p>This setting by default includes <code>kvm</code> if <code>/dev/kvm</code> is accessible,
and the pseudo-features <code>nixos-test</code>, <code>benchmark</code> and <code>big-parallel</code>
that are used in Nixpkgs to route builds to specific machines.</p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><a href="#conf-tarball-ttl"><code>tarball-ttl</code></a><p id="conf-tarball-ttl"></p></p>
<p>The number of seconds a downloaded tarball is considered fresh. If
the cached tarball is stale, Nix will check whether it is still up
to date using the ETag header. Nix will download a new version if
the ETag header is unsupported, or the cached ETag doesn't match.</p>
<p>Setting the TTL to <code>0</code> forces Nix to always check if the tarball is
up to date.</p>
<p>Nix caches tarballs in <code>$XDG_CACHE_HOME/nix/tarballs</code>.</p>
<p>Files fetched via <code>NIX_PATH</code>, <code>fetchGit</code>, <code>fetchMercurial</code>,
<code>fetchTarball</code>, and <code>fetchurl</code> respect this TTL.</p>
<p><strong>Default:</strong> <code>3600</code></p>
</li>
<li>
<p><a href="#conf-timeout"><code>timeout</code></a><p id="conf-timeout"></p></p>
<p>This option defines the maximum number of seconds that a builder can
run. This is useful (for instance in an automated build system) to
catch builds that are stuck in an infinite loop but keep writing to
their standard output or standard error. It can be overridden using
the <code>--timeout</code> command line switch.</p>
<p>The value <code>0</code> means that there is no timeout. This is also the
default.</p>
<p><strong>Default:</strong> <code>0</code></p>
<p><strong>Deprecated alias:</strong> <code>build-timeout</code></p>
</li>
<li>
<p><a href="#conf-trace-function-calls"><code>trace-function-calls</code></a><p id="conf-trace-function-calls"></p></p>
<p>If set to <code>true</code>, the Nix evaluator will trace every function call.
Nix will print a log message at the &quot;vomit&quot; level for every function
entrance and function exit.</p>
<pre><code>function-trace entered undefined position at 1565795816999559622
function-trace exited undefined position at 1565795816999581277
function-trace entered /nix/store/.../example.nix:226:41 at 1565795253249935150
function-trace exited /nix/store/.../example.nix:226:41 at 1565795253249941684
</code></pre>
<p>The <code>undefined position</code> means the function call is a builtin.</p>
<p>Use the <code>contrib/stack-collapse.py</code> script distributed with the Nix
source code to convert the trace logs in to a format suitable for
<code>flamegraph.pl</code>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-trace-verbose"><code>trace-verbose</code></a><p id="conf-trace-verbose"></p></p>
<p>Whether <code>builtins.traceVerbose</code> should trace its first argument when evaluated.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-trusted-public-keys"><code>trusted-public-keys</code></a><p id="conf-trusted-public-keys"></p></p>
<p>A whitespace-separated list of public keys. When paths are copied
from another Nix store (such as a binary cache), they must be
signed with one of these keys. For example:
<code>cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY= hydra.nixos.org-1:CNHJZBh9K4tP3EKF6FkkgeVYsS3ohTl+oS0Qa8bezVs=</code>.</p>
<p><strong>Default:</strong> <code>cache.nixos.org-1:6NCHdD59X431o0gWypbMrAURkbJ16ZPMQFGspcDShjY=</code></p>
<p><strong>Deprecated alias:</strong> <code>binary-cache-public-keys</code></p>
</li>
<li>
<p><a href="#conf-trusted-substituters"><code>trusted-substituters</code></a><p id="conf-trusted-substituters"></p></p>
<p>A list of URLs of substituters, separated by whitespace. These are
not used by default, but can be enabled by users of the Nix daemon
by specifying <code>--option substituters urls</code> on the command
line. Unprivileged users are only allowed to pass a subset of the
URLs listed in <code>substituters</code> and <code>trusted-substituters</code>.</p>
<p><strong>Default:</strong> <em>empty</em></p>
<p><strong>Deprecated alias:</strong> <code>trusted-binary-caches</code></p>
</li>
<li>
<p><a href="#conf-trusted-users"><code>trusted-users</code></a><p id="conf-trusted-users"></p></p>
<p>A list of names of users (separated by whitespace) that have
additional rights when connecting to the Nix daemon, such as the
ability to specify additional binary caches, or to import unsigned
NARs. You can also specify groups by prefixing them with <code>@</code>; for
instance, <code>@wheel</code> means all users in the <code>wheel</code> group. The default
is <code>root</code>.</p>
<blockquote>
<p><strong>Warning</strong></p>
<p>Adding a user to <code>trusted-users</code> is essentially equivalent to
giving that user root access to the system. For example, the user
can set <code>sandbox-paths</code> and thereby obtain read access to
directories that are otherwise inacessible to them.</p>
</blockquote>
<p><strong>Default:</strong> <code>root</code></p>
</li>
<li>
<p><a href="#conf-use-case-hack"><code>use-case-hack</code></a><p id="conf-use-case-hack"></p></p>
<p>Whether to enable a Darwin-specific hack for dealing with file name collisions.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-use-cgroups"><code>use-cgroups</code></a><p id="conf-use-cgroups"></p></p>
<p>Whether to execute builds inside cgroups.
This is only supported on Linux.</p>
<p>Cgroups are required and enabled automatically for derivations 
that require the <code>uid-range</code> system feature.</p>
<blockquote>
<p><strong>Warning</strong>
This is an experimental feature.</p>
</blockquote>
<p>To enable it, add the following to <a href="#"><code>nix.conf</code></a>:</p>
<pre><code>extra-experimental-features = cgroups
use-cgroups = true
</code></pre>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><a href="#conf-use-registries"><code>use-registries</code></a><p id="conf-use-registries"></p></p>
<p>Whether to use flake registries to resolve flake references.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-use-sqlite-wal"><code>use-sqlite-wal</code></a><p id="conf-use-sqlite-wal"></p></p>
<p>Whether SQLite should use WAL mode.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><a href="#conf-user-agent-suffix"><code>user-agent-suffix</code></a><p id="conf-user-agent-suffix"></p></p>
<p>String appended to the user agent in HTTP requests.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><a href="#conf-warn-dirty"><code>warn-dirty</code></a><p id="conf-warn-dirty"></p></p>
<p>Whether to warn about dirty Git/Mercurial trees.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../command-ref/files.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../glossary.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../command-ref/files.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../glossary.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../redirects.js"></script>


    </body>
</html>
