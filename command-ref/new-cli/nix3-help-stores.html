<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>nix help-stores - Nix 2.31.3 Reference Manual</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../../css/variables-8adf115d.css">
        <link rel="stylesheet" href="../../css/general-2459343d.css">
        <link rel="stylesheet" href="../../css/chrome-ae938929.css">
        <link rel="stylesheet" href="../../css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../../highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../../ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../custom-80d08c7f.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex-374ccf4d.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc-f3fccd7f.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">Nix 2.31.3 Reference Manual</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/NixOS/nix" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>
                        <a href="https://github.com/NixOS/nix/tree/master/doc/manual/source/command-ref/new-cli/nix3-help-stores.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <span class=fa-svg id="git-edit-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M421.7 220.3l-11.3 11.3-22.6 22.6-205 205c-6.6 6.6-14.8 11.5-23.8 14.1L30.8 511c-8.4 2.5-17.5 .2-23.7-6.1S-1.5 489.7 1 481.2L38.7 353.1c2.6-9 7.5-17.2 14.1-23.8l205-205 22.6-22.6 11.3-11.3 33.9 33.9 62.1 62.1 33.9 33.9zM96 353.9l-9.3 9.3c-.9 .9-1.6 2.1-2 3.4l-25.3 86 86-25.3c1.3-.4 2.5-1.1 3.4-2l9.3-9.3H112c-8.8 0-16-7.2-16-16V353.9zM453.3 19.3l39.4 39.4c25 25 25 65.5 0 90.5l-14.5 14.5-22.6 22.6-11.3 11.3-33.9-33.9-62.1-62.1L314.3 67.7l11.3-11.3 22.6-22.6 14.5-14.5c25-25 65.5-25 90.5 0z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <blockquote>
<p><strong>Warning</strong> <br>This program is
<a href="../../development/experimental-features.html#xp-feature-nix-command"><strong>experimental</strong></a>
and its interface is subject to change.</p>
</blockquote>
<h1 id="name"><a class="header" href="#name">Name</a></h1>
<p><code>nix help-stores</code> - show help about store types and their settings</p>
<h1 id="synopsis"><a class="header" href="#synopsis">Synopsis</a></h1>
<p><code>nix help-stores</code> [<em>option</em>…]</p>
<p>Nix supports different types of stores:</p>
<ul>
<li><a href="#dummy-store">Dummy Store</a></li>
<li><a href="#experimental-local-overlay-store">Experimental Local Overlay Store</a></li>
<li><a href="#experimental-ssh-store">Experimental SSH Store</a></li>
<li><a href="#experimental-ssh-store-with-filesystem-mounted">Experimental SSH Store with filesystem mounted</a></li>
<li><a href="#http-binary-cache-store">HTTP Binary Cache Store</a></li>
<li><a href="#local-binary-cache-store">Local Binary Cache Store</a></li>
<li><a href="#local-daemon-store">Local Daemon Store</a></li>
<li><a href="#local-store">Local Store</a></li>
<li><a href="#s3-binary-cache-store">S3 Binary Cache Store</a></li>
<li><a href="#ssh-store">SSH Store</a></li>
</ul>
<h2 id="store-url-format"><a class="header" href="#store-url-format">Store URL format</a></h2>
<p>Stores are specified using a URL-like syntax. For example, the command</p>
<pre><code class="language-console"># nix path-info --store https://cache.nixos.org/ --json \
  /nix/store/a7gvj343m05j2s32xcnwr35v31ynlypr-coreutils-9.1
</code></pre>
<p>fetches information about a store path in the HTTP binary cache
located at https://cache.nixos.org/, which is a type of store.</p>
<p>Store URLs can specify <strong>store settings</strong> using URL query strings,
i.e. by appending <code>?name1=value1&amp;name2=value2&amp;...</code> to the URL. For
instance,</p>
<pre><code>--store ssh://machine.example.org?ssh-key=/path/to/my/key
</code></pre>
<p>tells Nix to access the store on a remote machine via the SSH
protocol, using <code>/path/to/my/key</code> as the SSH private key. The
supported settings for each store type are documented below.</p>
<p>The special store URL <code>auto</code> causes Nix to automatically select a
store as follows:</p>
<ul>
<li>
<p>Use the <a href="#local-store">local store</a> <code>/nix/store</code> if <code>/nix/var/nix</code>
is writable by the current user.</p>
</li>
<li>
<p>Otherwise, if <code>/nix/var/nix/daemon-socket/socket</code> exists, <a href="#local-daemon-store">connect
to the Nix daemon listening on that socket</a>.</p>
</li>
<li>
<p>Otherwise, on Linux only, use the <a href="#local-store">local chroot store</a>
<code>~/.local/share/nix/root</code>, which will be created automatically if it
does not exist.</p>
</li>
<li>
<p>Otherwise, use the <a href="#local-store">local store</a> <code>/nix/store</code>.</p>
</li>
</ul>
<h1 id="dummy-store"><a class="header" href="#dummy-store">Dummy Store</a></h1>
<p><strong>Store URL format</strong>: <code>dummy://</code></p>
<p>This store type represents a store that contains no store paths and
cannot be written to. It’s useful when you want to use the Nix
evaluator when no actual Nix store exists, e.g.</p>
<pre><code class="language-console"># nix eval --store dummy:// --expr '1 + 2'
</code></pre>
<h2 id="settings"><a class="header" href="#settings">Settings</a></h2>
<ul>
<li>
<p><span id="store-dummy-store-path-info-cache-size"><a href="#store-dummy-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-dummy-store-priority"><a href="#store-dummy-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-dummy-store-store"><a href="#store-dummy-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-dummy-store-system-features"><a href="#store-dummy-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-dummy-store-trusted"><a href="#store-dummy-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-dummy-store-want-mass-query"><a href="#store-dummy-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="experimental-local-overlay-store"><a class="header" href="#experimental-local-overlay-store">Experimental Local Overlay Store</a></h1>
<blockquote>
<p><strong>Warning</strong></p>
<p>This store is part of an
<a href="../../development/experimental-features.html">experimental feature</a>.</p>
<p>To use this store, make sure the
<a href="../../development/experimental-features.html#xp-feature-local-overlay-store"><code>local-overlay-store</code> experimental feature</a>
is enabled.
For example, include the following in <a href="../../command-ref/conf-file.html"><code>nix.conf</code></a>:</p>
<pre><code>extra-experimental-features = local-overlay-store
</code></pre>
</blockquote>
<p><strong>Store URL format</strong>: <code>local-overlay</code></p>
<p>This store type is a variation of the [local store] designed to leverage Linux’s <a href="https://docs.kernel.org/filesystems/overlayfs.html">Overlay Filesystem</a> (OverlayFS for short).
Just as OverlayFS combines a lower and upper filesystem by treating the upper one as a patch against the lower, the local overlay store combines a lower store with an upper almost-[local store].
(“almost” because while the upper filesystems for OverlayFS is valid on its own, the upper almost-store is not a valid local store on its own because some references will dangle.)
To use this store, you will first need to configure an OverlayFS mountpoint <a href="#example-filesystem-layout">appropriately</a> as Nix will not do this for you (though it will verify the mountpoint is configured correctly).</p>
<h3 id="conceptual-parts-of-a-local-overlay-store"><a class="header" href="#conceptual-parts-of-a-local-overlay-store">Conceptual parts of a local overlay store</a></h3>
<p><em>This is a more abstract/conceptual description of the parts of a layered store, an authoritative reference.
For more “practical” instructions, see the worked-out example in the next subsection.</em></p>
<p>The parts of a local overlay store are as follows:</p>
<ul>
<li>
<p><strong>Lower store</strong>:</p>
<blockquote>
<p>Specified with the <a href="#store-experimental-local-overlay-store-lower-store"><code>lower-store</code></a> setting.</p>
</blockquote>
<p>This is any store implementation that includes a store directory as part of the native operating system filesystem.
For example, this could be a [local store], [local daemon store], or even another local overlay store.</p>
<p>The local overlay store never tries to modify the lower store in any way.
Something else could modify the lower store, but there are restrictions on this
Nix itself requires that this store only grow, and not change in other ways.
For example, new store objects can be added, but deleting or modifying store objects is not allowed in general, because that will confuse and corrupt any local overlay store using those objects.
(In addition, the underlying filesystem overlay mechanism may impose additional restrictions, see below.)</p>
<p>The lower store must not change while it is mounted as part of an overlay store.
To ensure it does not, you might want to mount the store directory read-only (which then requires the [read-only] parameter to be set to <code>true</code>).</p>
<ul>
<li>
<p><strong>Lower store directory</strong>:</p>
<blockquote>
<p>Specified with <code>lower-store.real</code> setting.</p>
</blockquote>
<p>This is the directory used/exposed by the lower store.</p>
<p>As specified above, Nix requires the local store can only grow not change in other ways.
Linux’s OverlayFS in addition imposes the further requirement that this directory cannot change at all.
That means that, while any local overlay store exists that is using this store as a lower store, this directory must not change.</p>
</li>
<li>
<p><strong>Lower metadata source</strong>:</p>
<blockquote>
<p>Not directly specified.
A consequence of the <code>lower-store</code> setting, depending on the type of lower store chosen.</p>
</blockquote>
<p>This is abstract, just some way to read the metadata of lower store <a href="../../store/store-object.html">store objects</a>.
For example it could be a SQLite database (for the [local store]), or a socket connection (for the [local daemon store]).</p>
<p>This need not be writable.
As stated above a local overlay store never tries to modify its lower store.
The lower store’s metadata is considered part of the lower store, just as the store’s <a href="../../store/file-system-object.html">file system objects</a> that appear in the store directory are.</p>
</li>
</ul>
</li>
<li>
<p><strong>Upper almost-store</strong>:</p>
<blockquote>
<p>Not directly specified.
Instead the constituent parts are independently specified as described below.</p>
</blockquote>
<p>This is almost but not quite just a [local store].
That is because taken in isolation, not as part of a local overlay store, by itself, it would appear corrupted.
But combined with everything else as part of an overlay local store, it is valid.</p>
<ul>
<li>
<p><strong>Upper layer directory</strong>:</p>
<blockquote>
<p>Specified with <a href="#store-experimental-local-overlay-store-upper-layer"><code>upper-layer</code></a> setting.</p>
</blockquote>
<p>This contains additional <a href="../../store/store-object.html">store objects</a>
(or, strictly speaking, their <a href="../../store/file-system-object.html">file system objects</a> that the local overlay store will extend the lower store with).</p>
</li>
<li>
<p><strong>Upper store directory</strong>:</p>
<blockquote>
<p>Specified with the <a href="#store-experimental-local-overlay-store-real"><code>real</code></a> setting.
This the same as the base local store setting, and can also be indirectly specified with the <a href="#store-experimental-local-overlay-store-root"><code>root</code></a> setting.</p>
</blockquote>
<p>This contains all the store objects from each of the two directories.</p>
<p>The lower store directory and upper layer directory are combined via OverlayFS to create this directory.
Nix doesn’t do this itself, because it typically wouldn’t have the permissions to do so, so it is the responsibility of the user to set this up first.
Nix can, however, optionally check that the OverlayFS mount settings appear as expected, matching Nix’s own settings.</p>
</li>
<li>
<p><strong>Upper SQLite database</strong>:</p>
<blockquote>
<p>Not directly specified.
The location of the database instead depends on the <a href="#store-experimental-local-overlay-store-state"><code>state</code></a> setting.
It is always <code>${state}/db</code>.</p>
</blockquote>
<p>This contains the metadata of all of the upper layer <a href="../../store/store-object.html">store objects</a> (everything beyond their file system objects), and also duplicate copies of some lower layer store object’s metadata.
The duplication is so the metadata for the <a href="../../glossary.html#gloss-closure">closure</a> of upper layer <a href="../../store/store-object.html">store objects</a> can be found entirely within the upper layer.
(This allows us to use the same SQL Schema as the [local store]’s SQLite database, as foreign keys in that schema enforce closure metadata to be self-contained in this way.)</p>
</li>
</ul>
</li>
</ul>
<h3 id="example-filesystem-layout"><a class="header" href="#example-filesystem-layout">Example filesystem layout</a></h3>
<p>Here is a worked out example of usage, following the concepts in the previous section.</p>
<p>Say we have the following paths:</p>
<ul>
<li>
<p><code>/mnt/example/merged-store/nix/store</code></p>
</li>
<li>
<p><code>/mnt/example/store-a/nix/store</code></p>
</li>
<li>
<p><code>/mnt/example/store-b</code></p>
</li>
</ul>
<p>Then the following store URI can be used to access a local-overlay store at <code>/mnt/example/merged-store</code>:</p>
<pre><code>local-overlay://?root=/mnt/example/merged-store&amp;lower-store=/mnt/example/store-a&amp;upper-layer=/mnt/example/store-b
</code></pre>
<p>The lower store directory is located at <code>/mnt/example/store-a/nix/store</code>, while the upper layer is at <code>/mnt/example/store-b</code>.</p>
<p>Before accessing the overlay store you will need to ensure the OverlayFS mount is set up correctly:</p>
<pre><code class="language-shell">mount -t overlay overlay \
  -o lowerdir="/mnt/example/store-a/nix/store" \
  -o upperdir="/mnt/example/store-b" \
  -o workdir="/mnt/example/workdir" \
  "/mnt/example/merged-store/nix/store"
</code></pre>
<p>Note that OverlayFS requires <code>/mnt/example/workdir</code> to be on the same volume as the <code>upperdir</code>.</p>
<p>By default, Nix will check that the mountpoint as been set up correctly and fail with an error if it has not.
You can override this behaviour by passing <a href="#store-experimental-local-overlay-store-check-mount"><code>check-mount=false</code></a> if you need to.</p>
<h2 id="settings-1"><a class="header" href="#settings-1">Settings</a></h2>
<ul>
<li>
<p><span id="store-experimental-local-overlay-store-build-dir"><a href="#store-experimental-local-overlay-store-build-dir"><code>build-dir</code></a></span></p>
<p>The directory on the host, in which derivations’ temporary build directories are created.</p>
<p>If not set, Nix will use the <code>builds</code> subdirectory of its configured state directory.</p>
<p>Note that builds are often performed by the Nix daemon, so its <code>build-dir</code> applies.</p>
<p>Nix will create this directory automatically with suitable permissions if it does not exist.
Otherwise its permissions must allow all users to traverse the directory (i.e. it must have <code>o+x</code> set, in unix parlance) for non-sandboxed builds to work correctly.</p>
<p>This is also the location where <a href="../../command-ref/opt-common.html#opt-keep-failed"><code>--keep-failed</code></a> leaves its files.</p>
<p>If Nix runs without sandbox, or if the platform does not support sandboxing with bind mounts (e.g. macOS), then the <a href="../../language/derivations.html#attr-builder"><code>builder</code></a>’s environment will contain this directory, instead of the virtual location <a href="#conf-sandbox-build-dir"><code>sandbox-build-dir</code></a>.</p>
<blockquote>
<p><strong>Warning</strong></p>
<p><code>build-dir</code> must not be set to a world-writable directory.
Placing temporary build directories in a world-writable place allows other users to access or modify build data that is currently in use.
This alone is merely an impurity, but combined with another factor this has allowed malicious derivations to escape the build sandbox.</p>
</blockquote>
<p>See also the global <a href="../../command-ref/conf-file.html#conf-build-dir"><code>build-dir</code></a> setting.</p>
<p><strong>Default:</strong> ``</p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-check-mount"><a href="#store-experimental-local-overlay-store-check-mount"><code>check-mount</code></a></span></p>
<p>Check that the overlay filesystem is correctly mounted.</p>
<p>Nix does not manage the overlayfs mount point itself, but the correct
functioning of the overlay store does depend on this mount point being set up
correctly. Rather than just assume this is the case, check that the lowerdir
and upperdir options are what we expect them to be. This check is on by
default, but can be disabled if needed.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-log"><a href="#store-experimental-local-overlay-store-log"><code>log</code></a></span></p>
<p>directory where Nix stores log files.</p>
<p><strong>Default:</strong> <code>/nix/var/log/nix</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-lower-store"><a href="#store-experimental-local-overlay-store-lower-store"><code>lower-store</code></a></span></p>
<p><a href="../../command-ref/new-cli/nix3-help-stores.html#store-url-format">Store URL</a>
for the lower store. The default is <code>auto</code> (i.e. use the Nix daemon or <code>/nix/store</code> directly).</p>
<p>Must be a store with a store dir on the file system.
Must be used as OverlayFS lower layer for this store’s store dir.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-path-info-cache-size"><a href="#store-experimental-local-overlay-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-priority"><a href="#store-experimental-local-overlay-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-read-only"><a href="#store-experimental-local-overlay-store-read-only"><code>read-only</code></a></span></p>
<p>Allow this store to be opened when its <a href="../../glossary.html#gloss-nix-database">database</a> is on a read-only filesystem.</p>
<p>Normally Nix attempts to open the store database in read-write mode, even for querying (when write access is not needed), causing it to fail if the database is on a read-only filesystem.</p>
<p>Enable read-only mode to disable locking and open the SQLite database with the <a href="https://www.sqlite.org/c3ref/open.html"><code>immutable</code> parameter</a> set.</p>
<blockquote>
<p><strong>Warning</strong>
Do not use this unless the filesystem is read-only.</p>
<p>Using it when the filesystem is writable can cause incorrect query results or corruption errors if the database is changed by another process.
While the filesystem the database resides on might appear to be read-only, consider whether another user or system might have write access to it.</p>
</blockquote>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-real"><a href="#store-experimental-local-overlay-store-real"><code>real</code></a></span></p>
<p>Physical path of the Nix store.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-remount-hook"><a href="#store-experimental-local-overlay-store-remount-hook"><code>remount-hook</code></a></span></p>
<p>Script or other executable to run when overlay filesystem needs remounting.</p>
<p>This is occasionally necessary when deleting a store path that exists in both upper and lower layers.
In such a situation, bypassing OverlayFS and deleting the path in the upper layer directly
is the only way to perform the deletion without creating a “whiteout”.
However this causes the OverlayFS kernel data structures to get out-of-sync,
and can lead to ‘stale file handle’ errors; remounting solves the problem.</p>
<p>The store directory is passed as an argument to the invoked executable.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-require-sigs"><a href="#store-experimental-local-overlay-store-require-sigs"><code>require-sigs</code></a></span></p>
<p>Whether store paths copied into this store should have a trusted signature.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-root"><a href="#store-experimental-local-overlay-store-root"><code>root</code></a></span></p>
<p>Directory prefixed to all other paths.</p>
<p><strong>Default:</strong> ``</p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-state"><a href="#store-experimental-local-overlay-store-state"><code>state</code></a></span></p>
<p>Directory where Nix stores state.</p>
<p><strong>Default:</strong> <code>/dummy</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-store"><a href="#store-experimental-local-overlay-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-system-features"><a href="#store-experimental-local-overlay-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-trusted"><a href="#store-experimental-local-overlay-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-upper-layer"><a href="#store-experimental-local-overlay-store-upper-layer"><code>upper-layer</code></a></span></p>
<p>Directory containing the OverlayFS upper layer for this store’s store dir.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-local-overlay-store-want-mass-query"><a href="#store-experimental-local-overlay-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="experimental-ssh-store-with-filesystem-mounted"><a class="header" href="#experimental-ssh-store-with-filesystem-mounted">Experimental SSH Store with filesystem mounted</a></h1>
<blockquote>
<p><strong>Warning</strong></p>
<p>This store is part of an
<a href="../../development/experimental-features.html">experimental feature</a>.</p>
<p>To use this store, make sure the
<a href="../../development/experimental-features.html#xp-feature-mounted-ssh-store"><code>mounted-ssh-store</code> experimental feature</a>
is enabled.
For example, include the following in <a href="../../command-ref/conf-file.html"><code>nix.conf</code></a>:</p>
<pre><code>extra-experimental-features = mounted-ssh-store
</code></pre>
</blockquote>
<p><strong>Store URL format</strong>: <code>mounted-ssh-ng://[username@]hostname</code></p>
<p>Experimental store type that allows full access to a Nix store on a remote machine,
and additionally requires that store be mounted in the local file system.</p>
<p>The mounting of that store is not managed by Nix, and must by managed manually.
It could be accomplished with SSHFS or NFS, for example.</p>
<p>The local file system is used to optimize certain operations.
For example, rather than serializing Nix archives and sending over the Nix channel,
we can directly access the file system data via the mount-point.</p>
<p>The local file system is also used to make certain operations possible that wouldn’t otherwise be.
For example, persistent GC roots can be created if they reside on the same file system as the remote store:
the remote side will create the symlinks necessary to avoid race conditions.</p>
<h2 id="settings-2"><a class="header" href="#settings-2">Settings</a></h2>
<ul>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-base64-ssh-public-host-key"><a href="#store-experimental-ssh-store-with-filesystem-mounted-base64-ssh-public-host-key"><code>base64-ssh-public-host-key</code></a></span></p>
<p>The public host key of the remote machine.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-compress"><a href="#store-experimental-ssh-store-with-filesystem-mounted-compress"><code>compress</code></a></span></p>
<p>Whether to enable SSH compression.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-log"><a href="#store-experimental-ssh-store-with-filesystem-mounted-log"><code>log</code></a></span></p>
<p>directory where Nix stores log files.</p>
<p><strong>Default:</strong> <code>/nix/var/log/nix</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-max-connection-age"><a href="#store-experimental-ssh-store-with-filesystem-mounted-max-connection-age"><code>max-connection-age</code></a></span></p>
<p>Maximum age of a connection before it is closed.</p>
<p><strong>Default:</strong> <code>4294967295</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-max-connections"><a href="#store-experimental-ssh-store-with-filesystem-mounted-max-connections"><code>max-connections</code></a></span></p>
<p>Maximum number of concurrent connections to the Nix daemon.</p>
<p><strong>Default:</strong> <code>1</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-path-info-cache-size"><a href="#store-experimental-ssh-store-with-filesystem-mounted-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-priority"><a href="#store-experimental-ssh-store-with-filesystem-mounted-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-real"><a href="#store-experimental-ssh-store-with-filesystem-mounted-real"><code>real</code></a></span></p>
<p>Physical path of the Nix store.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-remote-program"><a href="#store-experimental-ssh-store-with-filesystem-mounted-remote-program"><code>remote-program</code></a></span></p>
<p>Path to the <code>nix-daemon</code> executable on the remote machine.</p>
<p><strong>Default:</strong> <code>nix-daemon</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-remote-store"><a href="#store-experimental-ssh-store-with-filesystem-mounted-remote-store"><code>remote-store</code></a></span></p>
<p><a href="../../store/types/index.html#store-url-format">Store URL</a>
to be used on the remote machine. The default is <code>auto</code>
(i.e. use the Nix daemon or <code>/nix/store</code> directly).</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-root"><a href="#store-experimental-ssh-store-with-filesystem-mounted-root"><code>root</code></a></span></p>
<p>Directory prefixed to all other paths.</p>
<p><strong>Default:</strong> ``</p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-ssh-key"><a href="#store-experimental-ssh-store-with-filesystem-mounted-ssh-key"><code>ssh-key</code></a></span></p>
<p>Path to the SSH private key used to authenticate to the remote machine.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-state"><a href="#store-experimental-ssh-store-with-filesystem-mounted-state"><code>state</code></a></span></p>
<p>Directory where Nix stores state.</p>
<p><strong>Default:</strong> <code>/dummy</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-store"><a href="#store-experimental-ssh-store-with-filesystem-mounted-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-system-features"><a href="#store-experimental-ssh-store-with-filesystem-mounted-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-trusted"><a href="#store-experimental-ssh-store-with-filesystem-mounted-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-with-filesystem-mounted-want-mass-query"><a href="#store-experimental-ssh-store-with-filesystem-mounted-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="experimental-ssh-store"><a class="header" href="#experimental-ssh-store">Experimental SSH Store</a></h1>
<p><strong>Store URL format</strong>: <code>ssh-ng://[username@]hostname[:port]</code></p>
<p>Experimental store type that allows full access to a Nix store on a
remote machine.</p>
<h2 id="settings-3"><a class="header" href="#settings-3">Settings</a></h2>
<ul>
<li>
<p><span id="store-experimental-ssh-store-base64-ssh-public-host-key"><a href="#store-experimental-ssh-store-base64-ssh-public-host-key"><code>base64-ssh-public-host-key</code></a></span></p>
<p>The public host key of the remote machine.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-compress"><a href="#store-experimental-ssh-store-compress"><code>compress</code></a></span></p>
<p>Whether to enable SSH compression.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-max-connection-age"><a href="#store-experimental-ssh-store-max-connection-age"><code>max-connection-age</code></a></span></p>
<p>Maximum age of a connection before it is closed.</p>
<p><strong>Default:</strong> <code>4294967295</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-max-connections"><a href="#store-experimental-ssh-store-max-connections"><code>max-connections</code></a></span></p>
<p>Maximum number of concurrent connections to the Nix daemon.</p>
<p><strong>Default:</strong> <code>1</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-path-info-cache-size"><a href="#store-experimental-ssh-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-priority"><a href="#store-experimental-ssh-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-remote-program"><a href="#store-experimental-ssh-store-remote-program"><code>remote-program</code></a></span></p>
<p>Path to the <code>nix-daemon</code> executable on the remote machine.</p>
<p><strong>Default:</strong> <code>nix-daemon</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-remote-store"><a href="#store-experimental-ssh-store-remote-store"><code>remote-store</code></a></span></p>
<p><a href="../../store/types/index.html#store-url-format">Store URL</a>
to be used on the remote machine. The default is <code>auto</code>
(i.e. use the Nix daemon or <code>/nix/store</code> directly).</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-ssh-key"><a href="#store-experimental-ssh-store-ssh-key"><code>ssh-key</code></a></span></p>
<p>Path to the SSH private key used to authenticate to the remote machine.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-store"><a href="#store-experimental-ssh-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-system-features"><a href="#store-experimental-ssh-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-trusted"><a href="#store-experimental-ssh-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-experimental-ssh-store-want-mass-query"><a href="#store-experimental-ssh-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="http-binary-cache-store"><a class="header" href="#http-binary-cache-store">HTTP Binary Cache Store</a></h1>
<p><strong>Store URL format</strong>: <code>http://...</code>, <code>https://...</code></p>
<p>This store allows a binary cache to be accessed via the HTTP
protocol.</p>
<h2 id="settings-4"><a class="header" href="#settings-4">Settings</a></h2>
<ul>
<li>
<p><span id="store-http-binary-cache-store-compression"><a href="#store-http-binary-cache-store-compression"><code>compression</code></a></span></p>
<p>NAR compression method (<code>xz</code>, <code>bzip2</code>, <code>gzip</code>, <code>zstd</code>, or <code>none</code>).</p>
<p><strong>Default:</strong> <code>xz</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-compression-level"><a href="#store-http-binary-cache-store-compression-level"><code>compression-level</code></a></span></p>
<p>The <em>preset level</em> to be used when compressing NARs.
The meaning and accepted values depend on the compression method selected.
<code>-1</code> specifies that the default compression level should be used.</p>
<p><strong>Default:</strong> <code>-1</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-index-debug-info"><a href="#store-http-binary-cache-store-index-debug-info"><code>index-debug-info</code></a></span></p>
<p>Whether to index DWARF debug info files by build ID. This allows <a href="https://github.com/edolstra/dwarffs"><code>dwarffs</code></a> to
fetch debug info on demand</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-local-nar-cache"><a href="#store-http-binary-cache-store-local-nar-cache"><code>local-nar-cache</code></a></span></p>
<p>Path to a local cache of NARs fetched from this binary cache, used by commands such as <code>nix store cat</code>.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-parallel-compression"><a href="#store-http-binary-cache-store-parallel-compression"><code>parallel-compression</code></a></span></p>
<p>Enable multi-threaded compression of NARs. This is currently only available for <code>xz</code> and <code>zstd</code>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-path-info-cache-size"><a href="#store-http-binary-cache-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-priority"><a href="#store-http-binary-cache-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-secret-key"><a href="#store-http-binary-cache-store-secret-key"><code>secret-key</code></a></span></p>
<p>Path to the secret key used to sign the binary cache.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-secret-keys"><a href="#store-http-binary-cache-store-secret-keys"><code>secret-keys</code></a></span></p>
<p>List of comma-separated paths to the secret keys used to sign the binary cache.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-store"><a href="#store-http-binary-cache-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-system-features"><a href="#store-http-binary-cache-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-trusted"><a href="#store-http-binary-cache-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-want-mass-query"><a href="#store-http-binary-cache-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-http-binary-cache-store-write-nar-listing"><a href="#store-http-binary-cache-store-write-nar-listing"><code>write-nar-listing</code></a></span></p>
<p>Whether to write a JSON file that lists the files in each NAR.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="local-binary-cache-store"><a class="header" href="#local-binary-cache-store">Local Binary Cache Store</a></h1>
<p><strong>Store URL format</strong>: <code>file://</code><em>path</em></p>
<p>This store allows reading and writing a binary cache stored in <em>path</em>
in the local filesystem. If <em>path</em> does not exist, it will be created.</p>
<p>For example, the following builds or downloads <code>nixpkgs#hello</code> into
the local store and then copies it to the binary cache in
<code>/tmp/binary-cache</code>:</p>
<pre><code># nix copy --to file:///tmp/binary-cache nixpkgs#hello
</code></pre>
<h2 id="settings-5"><a class="header" href="#settings-5">Settings</a></h2>
<ul>
<li>
<p><span id="store-local-binary-cache-store-compression"><a href="#store-local-binary-cache-store-compression"><code>compression</code></a></span></p>
<p>NAR compression method (<code>xz</code>, <code>bzip2</code>, <code>gzip</code>, <code>zstd</code>, or <code>none</code>).</p>
<p><strong>Default:</strong> <code>xz</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-compression-level"><a href="#store-local-binary-cache-store-compression-level"><code>compression-level</code></a></span></p>
<p>The <em>preset level</em> to be used when compressing NARs.
The meaning and accepted values depend on the compression method selected.
<code>-1</code> specifies that the default compression level should be used.</p>
<p><strong>Default:</strong> <code>-1</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-index-debug-info"><a href="#store-local-binary-cache-store-index-debug-info"><code>index-debug-info</code></a></span></p>
<p>Whether to index DWARF debug info files by build ID. This allows <a href="https://github.com/edolstra/dwarffs"><code>dwarffs</code></a> to
fetch debug info on demand</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-local-nar-cache"><a href="#store-local-binary-cache-store-local-nar-cache"><code>local-nar-cache</code></a></span></p>
<p>Path to a local cache of NARs fetched from this binary cache, used by commands such as <code>nix store cat</code>.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-parallel-compression"><a href="#store-local-binary-cache-store-parallel-compression"><code>parallel-compression</code></a></span></p>
<p>Enable multi-threaded compression of NARs. This is currently only available for <code>xz</code> and <code>zstd</code>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-path-info-cache-size"><a href="#store-local-binary-cache-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-priority"><a href="#store-local-binary-cache-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-secret-key"><a href="#store-local-binary-cache-store-secret-key"><code>secret-key</code></a></span></p>
<p>Path to the secret key used to sign the binary cache.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-secret-keys"><a href="#store-local-binary-cache-store-secret-keys"><code>secret-keys</code></a></span></p>
<p>List of comma-separated paths to the secret keys used to sign the binary cache.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-store"><a href="#store-local-binary-cache-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-system-features"><a href="#store-local-binary-cache-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-trusted"><a href="#store-local-binary-cache-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-want-mass-query"><a href="#store-local-binary-cache-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-binary-cache-store-write-nar-listing"><a href="#store-local-binary-cache-store-write-nar-listing"><code>write-nar-listing</code></a></span></p>
<p>Whether to write a JSON file that lists the files in each NAR.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="local-daemon-store"><a class="header" href="#local-daemon-store">Local Daemon Store</a></h1>
<p><strong>Store URL format</strong>: <code>daemon</code>, <code>unix://</code><em>path</em></p>
<p>This store type accesses a Nix store by talking to a Nix daemon
listening on the Unix domain socket <em>path</em>. The store pseudo-URL
<code>daemon</code> is equivalent to <code>unix:///nix/var/nix/daemon-socket/socket</code>.</p>
<h2 id="settings-6"><a class="header" href="#settings-6">Settings</a></h2>
<ul>
<li>
<p><span id="store-local-daemon-store-log"><a href="#store-local-daemon-store-log"><code>log</code></a></span></p>
<p>directory where Nix stores log files.</p>
<p><strong>Default:</strong> <code>/nix/var/log/nix</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-max-connection-age"><a href="#store-local-daemon-store-max-connection-age"><code>max-connection-age</code></a></span></p>
<p>Maximum age of a connection before it is closed.</p>
<p><strong>Default:</strong> <code>4294967295</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-max-connections"><a href="#store-local-daemon-store-max-connections"><code>max-connections</code></a></span></p>
<p>Maximum number of concurrent connections to the Nix daemon.</p>
<p><strong>Default:</strong> <code>1</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-path-info-cache-size"><a href="#store-local-daemon-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-priority"><a href="#store-local-daemon-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-real"><a href="#store-local-daemon-store-real"><code>real</code></a></span></p>
<p>Physical path of the Nix store.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-root"><a href="#store-local-daemon-store-root"><code>root</code></a></span></p>
<p>Directory prefixed to all other paths.</p>
<p><strong>Default:</strong> ``</p>
</li>
<li>
<p><span id="store-local-daemon-store-state"><a href="#store-local-daemon-store-state"><code>state</code></a></span></p>
<p>Directory where Nix stores state.</p>
<p><strong>Default:</strong> <code>/dummy</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-store"><a href="#store-local-daemon-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-system-features"><a href="#store-local-daemon-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-local-daemon-store-trusted"><a href="#store-local-daemon-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-daemon-store-want-mass-query"><a href="#store-local-daemon-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="local-store"><a class="header" href="#local-store">Local Store</a></h1>
<p><strong>Store URL format</strong>: <code>local</code>, <em>root</em></p>
<p>This store type accesses a Nix store in the local filesystem directly
(i.e. not via the Nix daemon). <em>root</em> is an absolute path that is
prefixed to other directories such as the Nix store directory. The
store pseudo-URL <code>local</code> denotes a store that uses <code>/</code> as its root
directory.</p>
<p>A store that uses a <em>root</em> other than <code>/</code> is called a <em>chroot
store</em>. With such stores, the store directory is “logically” still
<code>/nix/store</code>, so programs stored in them can only be built and
executed by <code>chroot</code>-ing into <em>root</em>. Chroot stores only support
building and running on Linux when <a href="https://man7.org/linux/man-pages/man7/mount_namespaces.7.html"><code>mount namespaces</code></a> and <a href="https://man7.org/linux/man-pages/man7/user_namespaces.7.html"><code>user namespaces</code></a> are
enabled.</p>
<p>For example, the following uses <code>/tmp/root</code> as the chroot environment
to build or download <code>nixpkgs#hello</code> and then execute it:</p>
<pre><code class="language-console"># nix run --store /tmp/root nixpkgs#hello
Hello, world!
</code></pre>
<p>Here, the “physical” store location is <code>/tmp/root/nix/store</code>, and
Nix’s store metadata is in <code>/tmp/root/nix/var/nix/db</code>.</p>
<p>It is also possible, but not recommended, to change the “logical”
location of the Nix store from its default of <code>/nix/store</code>. This makes
it impossible to use default substituters such as
<code>https://cache.nixos.org/</code>, and thus you may have to build everything
locally. Here is an example:</p>
<pre><code class="language-console"># nix build --store 'local?store=/tmp/my-nix/store&amp;state=/tmp/my-nix/state&amp;log=/tmp/my-nix/log' nixpkgs#hello
</code></pre>
<h2 id="settings-7"><a class="header" href="#settings-7">Settings</a></h2>
<ul>
<li>
<p><span id="store-local-store-build-dir"><a href="#store-local-store-build-dir"><code>build-dir</code></a></span></p>
<p>The directory on the host, in which derivations’ temporary build directories are created.</p>
<p>If not set, Nix will use the <code>builds</code> subdirectory of its configured state directory.</p>
<p>Note that builds are often performed by the Nix daemon, so its <code>build-dir</code> applies.</p>
<p>Nix will create this directory automatically with suitable permissions if it does not exist.
Otherwise its permissions must allow all users to traverse the directory (i.e. it must have <code>o+x</code> set, in unix parlance) for non-sandboxed builds to work correctly.</p>
<p>This is also the location where <a href="../../command-ref/opt-common.html#opt-keep-failed"><code>--keep-failed</code></a> leaves its files.</p>
<p>If Nix runs without sandbox, or if the platform does not support sandboxing with bind mounts (e.g. macOS), then the <a href="../../language/derivations.html#attr-builder"><code>builder</code></a>’s environment will contain this directory, instead of the virtual location <a href="#conf-sandbox-build-dir"><code>sandbox-build-dir</code></a>.</p>
<blockquote>
<p><strong>Warning</strong></p>
<p><code>build-dir</code> must not be set to a world-writable directory.
Placing temporary build directories in a world-writable place allows other users to access or modify build data that is currently in use.
This alone is merely an impurity, but combined with another factor this has allowed malicious derivations to escape the build sandbox.</p>
</blockquote>
<p>See also the global <a href="../../command-ref/conf-file.html#conf-build-dir"><code>build-dir</code></a> setting.</p>
<p><strong>Default:</strong> ``</p>
</li>
<li>
<p><span id="store-local-store-log"><a href="#store-local-store-log"><code>log</code></a></span></p>
<p>directory where Nix stores log files.</p>
<p><strong>Default:</strong> <code>/nix/var/log/nix</code></p>
</li>
<li>
<p><span id="store-local-store-path-info-cache-size"><a href="#store-local-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-local-store-priority"><a href="#store-local-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-local-store-read-only"><a href="#store-local-store-read-only"><code>read-only</code></a></span></p>
<p>Allow this store to be opened when its <a href="../../glossary.html#gloss-nix-database">database</a> is on a read-only filesystem.</p>
<p>Normally Nix attempts to open the store database in read-write mode, even for querying (when write access is not needed), causing it to fail if the database is on a read-only filesystem.</p>
<p>Enable read-only mode to disable locking and open the SQLite database with the <a href="https://www.sqlite.org/c3ref/open.html"><code>immutable</code> parameter</a> set.</p>
<blockquote>
<p><strong>Warning</strong>
Do not use this unless the filesystem is read-only.</p>
<p>Using it when the filesystem is writable can cause incorrect query results or corruption errors if the database is changed by another process.
While the filesystem the database resides on might appear to be read-only, consider whether another user or system might have write access to it.</p>
</blockquote>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-store-real"><a href="#store-local-store-real"><code>real</code></a></span></p>
<p>Physical path of the Nix store.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-local-store-require-sigs"><a href="#store-local-store-require-sigs"><code>require-sigs</code></a></span></p>
<p>Whether store paths copied into this store should have a trusted signature.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><span id="store-local-store-root"><a href="#store-local-store-root"><code>root</code></a></span></p>
<p>Directory prefixed to all other paths.</p>
<p><strong>Default:</strong> ``</p>
</li>
<li>
<p><span id="store-local-store-state"><a href="#store-local-store-state"><code>state</code></a></span></p>
<p>Directory where Nix stores state.</p>
<p><strong>Default:</strong> <code>/dummy</code></p>
</li>
<li>
<p><span id="store-local-store-store"><a href="#store-local-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-local-store-system-features"><a href="#store-local-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-local-store-trusted"><a href="#store-local-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-store-want-mass-query"><a href="#store-local-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="s3-binary-cache-store"><a class="header" href="#s3-binary-cache-store">S3 Binary Cache Store</a></h1>
<p><strong>Store URL format</strong>: <code>s3://</code><em>bucket-name</em></p>
<p>This store allows reading and writing a binary cache stored in an AWS S3 (or S3-compatible service) bucket.
This store shares many idioms with the <a href="../../store/types/http-binary-cache-store.html">HTTP Binary Cache Store</a>.</p>
<p>For AWS S3, the binary cache URL for a bucket named <code>example-nix-cache</code> will be exactly <a href="s3://example-nix-cache">s3://example-nix-cache</a>.
For S3 compatible binary caches, consult that cache’s documentation.</p>
<h3 id="anonymous-reads-to-your-s3-compatible-binary-cache"><a class="header" href="#anonymous-reads-to-your-s3-compatible-binary-cache">Anonymous reads to your S3-compatible binary cache</a></h3>
<blockquote>
<p>If your binary cache is publicly accessible and does not require authentication,
it is simplest to use the [HTTP Binary Cache Store] rather than S3 Binary Cache Store with
<a href="https://example-nix-cache.s3.amazonaws.com">https://example-nix-cache.s3.amazonaws.com</a> instead of <a href="s3://example-nix-cache">s3://example-nix-cache</a>.</p>
</blockquote>
<p>Your bucket will need a
<a href="https://docs.aws.amazon.com/AmazonS3/v1/userguide/bucket-policies.html">bucket policy</a>
like the following to be accessible:</p>
<pre><code class="language-json">{
    "Id": "DirectReads",
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "AllowDirectReads",
            "Action": [
                "s3:GetObject",
                "s3:GetBucketLocation"
            ],
            "Effect": "Allow",
            "Resource": [
                "arn:aws:s3:::example-nix-cache",
                "arn:aws:s3:::example-nix-cache/*"
            ],
            "Principal": "*"
        }
    ]
}
</code></pre>
<h3 id="authentication"><a class="header" href="#authentication">Authentication</a></h3>
<p>Nix will use the
<a href="https://docs.aws.amazon.com/sdk-for-cpp/v1/developer-guide/credentials.html">default credential provider chain</a>
for authenticating requests to Amazon S3.</p>
<p>Note that this means Nix will read environment variables and files with different idioms than with Nix’s own settings, as implemented by the AWS SDK.
Consult the documentation linked above for further details.</p>
<h3 id="authenticated-reads-to-your-s3-binary-cache"><a class="header" href="#authenticated-reads-to-your-s3-binary-cache">Authenticated reads to your S3 binary cache</a></h3>
<p>Your bucket will need a bucket policy allowing the desired users to perform the <code>s3:GetObject</code> and <code>s3:GetBucketLocation</code> action on all objects in the bucket.
The <a href="#anonymous-reads-to-your-s3-compatible-binary-cache">anonymous policy given above</a> can be updated to have a restricted <code>Principal</code> to support this.</p>
<h3 id="authenticated-writes-to-your-s3-compatible-binary-cache"><a class="header" href="#authenticated-writes-to-your-s3-compatible-binary-cache">Authenticated writes to your S3-compatible binary cache</a></h3>
<p>Your account will need an IAM policy to support uploading to the bucket:</p>
<pre><code class="language-json">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "UploadToCache",
      "Effect": "Allow",
      "Action": [
        "s3:AbortMultipartUpload",
        "s3:GetBucketLocation",
        "s3:GetObject",
        "s3:ListBucket",
        "s3:ListBucketMultipartUploads",
        "s3:ListMultipartUploadParts",
        "s3:PutObject"
      ],
      "Resource": [
        "arn:aws:s3:::example-nix-cache",
        "arn:aws:s3:::example-nix-cache/*"
      ]
    }
  ]
}
</code></pre>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<p>With bucket policies and authentication set up as described above, uploading works via <a href="../../command-ref/new-cli/nix3-copy.html"><code>nix copy</code></a> (experimental).</p>
<ul>
<li>
<p>To upload with a specific credential profile for Amazon S3:</p>
<pre><code class="language-console">$ nix copy nixpkgs.hello \
  --to 's3://example-nix-cache?profile=cache-upload&amp;region=eu-west-2'
</code></pre>
</li>
<li>
<p>To upload to an S3-compatible binary cache:</p>
<pre><code class="language-console">$ nix copy nixpkgs.hello --to \
  's3://example-nix-cache?profile=cache-upload&amp;scheme=https&amp;endpoint=minio.example.com'
</code></pre>
</li>
</ul>
<h2 id="settings-8"><a class="header" href="#settings-8">Settings</a></h2>
<ul>
<li>
<p><span id="store-s3-binary-cache-store-buffer-size"><a href="#store-s3-binary-cache-store-buffer-size"><code>buffer-size</code></a></span></p>
<p>Size (in bytes) of each part in multi-part uploads.</p>
<p><strong>Default:</strong> <code>5242880</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-compression"><a href="#store-s3-binary-cache-store-compression"><code>compression</code></a></span></p>
<p>NAR compression method (<code>xz</code>, <code>bzip2</code>, <code>gzip</code>, <code>zstd</code>, or <code>none</code>).</p>
<p><strong>Default:</strong> <code>xz</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-compression-level"><a href="#store-s3-binary-cache-store-compression-level"><code>compression-level</code></a></span></p>
<p>The <em>preset level</em> to be used when compressing NARs.
The meaning and accepted values depend on the compression method selected.
<code>-1</code> specifies that the default compression level should be used.</p>
<p><strong>Default:</strong> <code>-1</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-endpoint"><a href="#store-s3-binary-cache-store-endpoint"><code>endpoint</code></a></span></p>
<p>The URL of the endpoint of an S3-compatible service such as MinIO.
Do not specify this setting if you’re using Amazon S3.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>This endpoint must support HTTPS and uses path-based
addressing instead of virtual host based addressing.</p>
</blockquote>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-index-debug-info"><a href="#store-s3-binary-cache-store-index-debug-info"><code>index-debug-info</code></a></span></p>
<p>Whether to index DWARF debug info files by build ID. This allows <a href="https://github.com/edolstra/dwarffs"><code>dwarffs</code></a> to
fetch debug info on demand</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-local-nar-cache"><a href="#store-s3-binary-cache-store-local-nar-cache"><code>local-nar-cache</code></a></span></p>
<p>Path to a local cache of NARs fetched from this binary cache, used by commands such as <code>nix store cat</code>.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-log-compression"><a href="#store-s3-binary-cache-store-log-compression"><code>log-compression</code></a></span></p>
<p>Compression method for <code>log/*</code> files. It is recommended to
use a compression method supported by most web browsers
(e.g. <code>brotli</code>).</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-ls-compression"><a href="#store-s3-binary-cache-store-ls-compression"><code>ls-compression</code></a></span></p>
<p>Compression method for <code>.ls</code> files.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-multipart-upload"><a href="#store-s3-binary-cache-store-multipart-upload"><code>multipart-upload</code></a></span></p>
<p>Whether to use multi-part uploads.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-narinfo-compression"><a href="#store-s3-binary-cache-store-narinfo-compression"><code>narinfo-compression</code></a></span></p>
<p>Compression method for <code>.narinfo</code> files.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-parallel-compression"><a href="#store-s3-binary-cache-store-parallel-compression"><code>parallel-compression</code></a></span></p>
<p>Enable multi-threaded compression of NARs. This is currently only available for <code>xz</code> and <code>zstd</code>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-path-info-cache-size"><a href="#store-s3-binary-cache-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-priority"><a href="#store-s3-binary-cache-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-profile"><a href="#store-s3-binary-cache-store-profile"><code>profile</code></a></span></p>
<p>The name of the AWS configuration profile to use. By default
Nix uses the <code>default</code> profile.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-region"><a href="#store-s3-binary-cache-store-region"><code>region</code></a></span></p>
<p>The region of the S3 bucket. If your bucket is not in
<code>us-east-1</code>, you should always explicitly specify the region
parameter.</p>
<p><strong>Default:</strong> <code>us-east-1</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-scheme"><a href="#store-s3-binary-cache-store-scheme"><code>scheme</code></a></span></p>
<p>The scheme used for S3 requests, <code>https</code> (default) or <code>http</code>. This
option allows you to disable HTTPS for binary caches which don’t
support it.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>HTTPS should be used if the cache might contain sensitive
information.</p>
</blockquote>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-secret-key"><a href="#store-s3-binary-cache-store-secret-key"><code>secret-key</code></a></span></p>
<p>Path to the secret key used to sign the binary cache.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-secret-keys"><a href="#store-s3-binary-cache-store-secret-keys"><code>secret-keys</code></a></span></p>
<p>List of comma-separated paths to the secret keys used to sign the binary cache.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-store"><a href="#store-s3-binary-cache-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-system-features"><a href="#store-s3-binary-cache-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-trusted"><a href="#store-s3-binary-cache-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-want-mass-query"><a href="#store-s3-binary-cache-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-s3-binary-cache-store-write-nar-listing"><a href="#store-s3-binary-cache-store-write-nar-listing"><code>write-nar-listing</code></a></span></p>
<p>Whether to write a JSON file that lists the files in each NAR.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="ssh-store"><a class="header" href="#ssh-store">SSH Store</a></h1>
<p><strong>Store URL format</strong>: <code>ssh://[username@]hostname[:port]</code></p>
<p>This store type allows limited access to a remote store on another
machine via SSH.</p>
<h2 id="settings-9"><a class="header" href="#settings-9">Settings</a></h2>
<ul>
<li>
<p><span id="store-ssh-store-base64-ssh-public-host-key"><a href="#store-ssh-store-base64-ssh-public-host-key"><code>base64-ssh-public-host-key</code></a></span></p>
<p>The public host key of the remote machine.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-ssh-store-compress"><a href="#store-ssh-store-compress"><code>compress</code></a></span></p>
<p>Whether to enable SSH compression.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-ssh-store-log-fd"><a href="#store-ssh-store-log-fd"><code>log-fd</code></a></span></p>
<p>file descriptor to which SSH’s stderr is connected</p>
<p><strong>Default:</strong> <code>-1</code></p>
</li>
<li>
<p><span id="store-ssh-store-max-connections"><a href="#store-ssh-store-max-connections"><code>max-connections</code></a></span></p>
<p>Maximum number of concurrent SSH connections.</p>
<p><strong>Default:</strong> <code>1</code></p>
</li>
<li>
<p><span id="store-ssh-store-path-info-cache-size"><a href="#store-ssh-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-ssh-store-priority"><a href="#store-ssh-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-ssh-store-remote-program"><a href="#store-ssh-store-remote-program"><code>remote-program</code></a></span></p>
<p>Path to the <code>nix-store</code> executable on the remote machine.</p>
<p><strong>Default:</strong> <code>nix-store</code></p>
</li>
<li>
<p><span id="store-ssh-store-remote-store"><a href="#store-ssh-store-remote-store"><code>remote-store</code></a></span></p>
<p><a href="../../store/types/index.html#store-url-format">Store URL</a>
to be used on the remote machine. The default is <code>auto</code>
(i.e. use the Nix daemon or <code>/nix/store</code> directly).</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-ssh-store-ssh-key"><a href="#store-ssh-store-ssh-key"><code>ssh-key</code></a></span></p>
<p>Path to the SSH private key used to authenticate to the remote machine.</p>
<p><strong>Default:</strong> <em>empty</em></p>
</li>
<li>
<p><span id="store-ssh-store-store"><a href="#store-ssh-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-ssh-store-system-features"><a href="#store-ssh-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-ssh-store-trusted"><a href="#store-ssh-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-ssh-store-want-mass-query"><a href="#store-ssh-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>
<h1 id="options"><a class="header" href="#options">Options</a></h1>
<h2 id="logging-related-options"><a class="header" href="#logging-related-options">Logging-related options</a></h2>
<ul>
<li>
<p><span id="opt-debug"><a href="#opt-debug"><code>--debug</code></a></span></p>
<p>Set the logging verbosity level to ‘debug’.</p>
</li>
<li>
<p><span id="opt-log-format"><a href="#opt-log-format"><code>--log-format</code></a></span> <em>format</em></p>
<p>Set the format of log output; one of <code>raw</code>, <code>internal-json</code>, <code>bar</code> or <code>bar-with-logs</code>.</p>
</li>
<li>
<p><span id="opt-print-build-logs"><a href="#opt-print-build-logs"><code>--print-build-logs</code></a></span> / <code>-L</code></p>
<p>Print full build logs on standard error.</p>
</li>
<li>
<p><span id="opt-quiet"><a href="#opt-quiet"><code>--quiet</code></a></span></p>
<p>Decrease the logging verbosity level.</p>
</li>
<li>
<p><span id="opt-verbose"><a href="#opt-verbose"><code>--verbose</code></a></span> / <code>-v</code></p>
<p>Increase the logging verbosity level.</p>
</li>
</ul>
<h2 id="miscellaneous-global-options"><a class="header" href="#miscellaneous-global-options">Miscellaneous global options</a></h2>
<ul>
<li>
<p><span id="opt-help"><a href="#opt-help"><code>--help</code></a></span></p>
<p>Show usage information.</p>
</li>
<li>
<p><span id="opt-offline"><a href="#opt-offline"><code>--offline</code></a></span></p>
<p>Disable substituters and consider all previously downloaded files up-to-date.</p>
</li>
<li>
<p><span id="opt-option"><a href="#opt-option"><code>--option</code></a></span> <em>name</em> <em>value</em></p>
<p>Set the Nix configuration setting <em>name</em> to <em>value</em> (overriding <code>nix.conf</code>).</p>
</li>
<li>
<p><span id="opt-refresh"><a href="#opt-refresh"><code>--refresh</code></a></span></p>
<p>Consider all previously downloaded files out-of-date.</p>
</li>
<li>
<p><span id="opt-version"><a href="#opt-version"><code>--version</code></a></span></p>
<p>Show version information.</p>
</li>
</ul>
<blockquote>
<p><strong>Note</strong></p>
<p>See <a href="../../command-ref/conf-file.html#command-line-flags"><code>man nix.conf</code></a> for overriding configuration settings with command line flags.</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../command-ref/new-cli/nix3-help.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="../../command-ref/new-cli/nix3-key.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../command-ref/new-cli/nix3-help.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="../../command-ref/new-cli/nix3-key.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../../mark-09e88c2c.min.js"></script>
        <script src="../../searcher-c2a407aa.js"></script>

        <script src="../../clipboard-1626706a.min.js"></script>
        <script src="../../highlight-862e895d.js"></script>
        <script src="../../book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../redirects-4afb32ee.js"></script>



    </div>
    </body>
</html>
