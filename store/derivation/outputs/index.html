<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Derivation Outputs and Types of Derivations - Nix 2.28.5 Reference Manual</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../favicon.svg">
        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Nix 2.28.5 Reference Manual</h1>

                    <div class="right-buttons">
                        <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/NixOS/nix" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/NixOS/nix/tree/master/doc/manual/source/store/derivation/outputs/index.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="derivation-outputs-and-types-of-derivations"><a class="header" href="#derivation-outputs-and-types-of-derivations">Derivation Outputs and Types of Derivations</a></h1>
<p>As stated on the <a href="../index.html#store-derivation">main pages on derivations</a>,
a derivation produces <a href="../../../store/store-object.html">store objects</a>, which are known as the <em>outputs</em> of the derivation.
Indeed, the entire point of derivations is to produce these outputs, and to reliably and reproducibly produce these derivations each time the derivation is run.</p>
<p>One of the parts of a derivation is its <em>outputs specification</em>, which specifies certain information about the outputs the derivation produces when run.
The outputs specification is a map, from names to specifications for individual outputs.</p>
<h2 id="outputs"><a class="header" href="#outputs">Output Names</a></h2>
<p>Output names can be any string which is also a valid <a href="../../../store/store-path.html">store path</a> name.
The name mapped to each output specification is not actually the name of the output.
In the general case, the output store object has name <code>derivationName + "-" + outputSpecName</code>, not any other metadata about it.
However, an output spec named "out" describes and output store object whose name is just the derivation name.</p>
<blockquote>
<p><strong>Example</strong></p>
<p>A derivation is named <code>hello</code>, and has two outputs, <code>out</code>, and <code>dev</code></p>
<ul>
<li>
<p>The derivation's path will be: <code>/nix/store/&lt;hash&gt;-hello.drv</code>.</p>
</li>
<li>
<p>The store path of <code>out</code> will be: <code>/nix/store/&lt;hash&gt;-hello</code>.</p>
</li>
<li>
<p>The store path of <code>dev</code> will be: <code>/nix/store/&lt;hash&gt;-hello-dev</code>.</p>
</li>
</ul>
</blockquote>
<p>The outputs are the derivations are the <a href="../../../store/store-object.html">store objects</a> it is obligated to produce.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>The formal terminology here is somewhat at odds with everyday communication in the Nix community today.
"output" in casual usage tends to refer to either to the actual output store object, or the notional output spec, depending on context.</p>
<p>For example "hello's <code>dev</code> output" means the store object referred to by the store path <code>/nix/store/&lt;hash&gt;-hello-dev</code>.
It is unusual to call this the "<code>hello-dev</code> output", even though <code>hello-dev</code> is the actual name of that store object.</p>
</blockquote>
<h2 id="types-of-output-addressing"><a class="header" href="#types-of-output-addressing">Types of output addressing</a></h2>
<p>The main information contained in an output specification is how the derivation output is addressed.
In particular, the specification decides:</p>
<ul>
<li>
<p>whether the output is <a href="./content-address.html">content-addressed</a> or <a href="./input-address.html">input-addressed</a></p>
</li>
<li>
<p>if the content is content-addressed, how is it content addressed</p>
</li>
<li>
<p>if the content is content-addressed, <a href="./content-address.html#fixed-content-addressing">what is its content address</a> (and thus what is its [store path])</p>
</li>
</ul>
<h2 id="types-of-derivations"><a class="header" href="#types-of-derivations">Types of derivations</a></h2>
<p>The sections on each type of derivation output addressing ended up discussing other attributes of the derivation besides its outputs, such as purity, scheduling, determinism, etc.
This is no concidence; for the type of a derivation is in fact one-for-one with the type of its outputs:</p>
<ul>
<li>A derivation that produces <em>xyz-addressed</em> outputs is an <em>xyz-addressing</em> derivations.</li>
</ul>
<p>The rules for this are fairly concise:</p>
<ul>
<li>
<p>All the outputs must be of the same type / use the same addressing</p>
<ul>
<li>
<p>The derivation must have at least one output</p>
</li>
<li>
<p>Additionally, if the outputs are fixed content-addressed, there must be exactly one output, whose specification is mapped from the name <code>out</code>.
(The name <code>out</code> is special, according to the rules described above.
Having only one output and calling its specification <code>out</code> means the single output is effectively anonymous; the store path just has the derivation name.)</p>
<p>(This is an arbitrary restriction that could be lifted.)</p>
</li>
</ul>
</li>
<li>
<p>The output is either <em>fixed</em> or <em>floating</em>, indicating whether the store path is known prior to building it.</p>
<ul>
<li>
<p>With fixed content-addressing it is fixed.</p>
<blockquote>
<p>A <em>fixed content-addressing</em> derivation is also called a <em>fixed-output derivation</em>, since that is the only currently-implemented form of fixed-output addressing</p>
</blockquote>
</li>
<li>
<p>With floating content-addressing or input-addressing it is floating.</p>
</li>
</ul>
<blockquote>
<p>Thus, historically with Nix, with no experimental features enabled, <em>all</em> outputs are fixed.</p>
</blockquote>
</li>
<li>
<p>The derivation may be <em>pure</em> or <em>impure</em>, indicating what read access to the outside world the <a href="../index.html#builder">builder</a> has.</p>
<ul>
<li>
<p>An input-addressing derivation <em>must</em> be pure.</p>
<blockquote>
<p>If it is impure, we would have a large problem, because an input-addressed derivation always produces outputs with the same paths.</p>
</blockquote>
</li>
<li>
<p>A content-addressing derivation may be pure or impure</p>
</li>
<li>
<p>If it is impure, it may be fixed (typical), or it may be floating if the additional <a href="../../../development/experimental-features.html#xp-feature-impure-derivations"><code>impure-derivations</code></a> experimental feature is enabled.</p>
</li>
<li>
<p>If it is pure, it must be floating.</p>
</li>
<li>
<p>Pure, fixed content-addressing derivations are not supported</p>
<blockquote>
<p>There is no use for this forth combination.
The sole purpose of an output's store path being fixed is to support the derivation being impure.</p>
</blockquote>
</li>
</ul>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../store/derivation/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../store/derivation/outputs/content-address.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../store/derivation/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../store/derivation/outputs/content-address.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../elasticlunr.min.js"></script>
        <script src="../../../mark.min.js"></script>
        <script src="../../../searcher.js"></script>

        <script src="../../../clipboard.min.js"></script>
        <script src="../../../highlight.js"></script>
        <script src="../../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../../redirects.js"></script>



    </div>
    </body>
</html>
