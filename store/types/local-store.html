<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Local Store - Nix 2.28.4 Reference Manual</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Nix 2.28.4 Reference Manual</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/NixOS/nix" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/NixOS/nix/tree/master/doc/manual/source/store/types/local-store.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="local-store"><a class="header" href="#local-store">Local Store</a></h1>
<p><strong>Store URL format</strong>: <code>local</code>, <em>root</em></p>
<p>This store type accesses a Nix store in the local filesystem directly
(i.e. not via the Nix daemon). <em>root</em> is an absolute path that is
prefixed to other directories such as the Nix store directory. The
store pseudo-URL <code>local</code> denotes a store that uses <code>/</code> as its root
directory.</p>
<p>A store that uses a <em>root</em> other than <code>/</code> is called a <em>chroot
store</em>. With such stores, the store directory is "logically" still
<code>/nix/store</code>, so programs stored in them can only be built and
executed by <code>chroot</code>-ing into <em>root</em>. Chroot stores only support
building and running on Linux when <a href="https://man7.org/linux/man-pages/man7/mount_namespaces.7.html"><code>mount namespaces</code></a> and <a href="https://man7.org/linux/man-pages/man7/user_namespaces.7.html"><code>user namespaces</code></a> are
enabled.</p>
<p>For example, the following uses <code>/tmp/root</code> as the chroot environment
to build or download <code>nixpkgs#hello</code> and then execute it:</p>
<pre><code class="language-console"># nix run --store /tmp/root nixpkgs#hello
Hello, world!
</code></pre>
<p>Here, the "physical" store location is <code>/tmp/root/nix/store</code>, and
Nix's store metadata is in <code>/tmp/root/nix/var/nix/db</code>.</p>
<p>It is also possible, but not recommended, to change the "logical"
location of the Nix store from its default of <code>/nix/store</code>. This makes
it impossible to use default substituters such as
<code>https://cache.nixos.org/</code>, and thus you may have to build everything
locally. Here is an example:</p>
<pre><code class="language-console"># nix build --store 'local?store=/tmp/my-nix/store&amp;state=/tmp/my-nix/state&amp;log=/tmp/my-nix/log' nixpkgs#hello
</code></pre>
<h2 id="settings"><a class="header" href="#settings">Settings</a></h2>
<ul>
<li>
<p><span id="store-local-store-log"><a href="#store-local-store-log"><code>log</code></a></span></p>
<p>directory where Nix will store log files.</p>
<p><strong>Default:</strong> <code>/nix/var/log/nix</code></p>
</li>
<li>
<p><span id="store-local-store-path-info-cache-size"><a href="#store-local-store-path-info-cache-size"><code>path-info-cache-size</code></a></span></p>
<p>Size of the in-memory store path metadata cache.</p>
<p><strong>Default:</strong> <code>65536</code></p>
</li>
<li>
<p><span id="store-local-store-priority"><a href="#store-local-store-priority"><code>priority</code></a></span></p>
<p>Priority of this store when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.
A lower value means a higher priority.</p>
<p><strong>Default:</strong> <code>0</code></p>
</li>
<li>
<p><span id="store-local-store-read-only"><a href="#store-local-store-read-only"><code>read-only</code></a></span></p>
<p>Allow this store to be opened when its <a href="../../glossary.html#gloss-nix-database">database</a> is on a read-only filesystem.</p>
<p>Normally Nix will attempt to open the store database in read-write mode, even for querying (when write access is not needed), causing it to fail if the database is on a read-only filesystem.</p>
<p>Enable read-only mode to disable locking and open the SQLite database with the <a href="https://www.sqlite.org/c3ref/open.html"><code>immutable</code> parameter</a> set.</p>
<blockquote>
<p><strong>Warning</strong>
Do not use this unless the filesystem is read-only.</p>
<p>Using it when the filesystem is writable can cause incorrect query results or corruption errors if the database is changed by another process.
While the filesystem the database resides on might appear to be read-only, consider whether another user or system might have write access to it.</p>
</blockquote>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-store-real"><a href="#store-local-store-real"><code>real</code></a></span></p>
<p>Physical path of the Nix store.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-local-store-require-sigs"><a href="#store-local-store-require-sigs"><code>require-sigs</code></a></span></p>
<p>Whether store paths copied into this store should have a trusted signature.</p>
<p><strong>Default:</strong> <code>true</code></p>
</li>
<li>
<p><span id="store-local-store-root"><a href="#store-local-store-root"><code>root</code></a></span></p>
<p>Directory prefixed to all other paths.</p>
<p><strong>Default:</strong> ``</p>
</li>
<li>
<p><span id="store-local-store-state"><a href="#store-local-store-state"><code>state</code></a></span></p>
<p>Directory where Nix will store state.</p>
<p><strong>Default:</strong> <code>/dummy</code></p>
</li>
<li>
<p><span id="store-local-store-store"><a href="#store-local-store-store"><code>store</code></a></span></p>
<p>Logical location of the Nix store, usually
<code>/nix/store</code>. Note that you can only copy store paths
between stores if they have the same <code>store</code> setting.</p>
<p><strong>Default:</strong> <code>/nix/store</code></p>
</li>
<li>
<p><span id="store-local-store-system-features"><a href="#store-local-store-system-features"><code>system-features</code></a></span></p>
<p>Optional <a href="../../command-ref/conf-file.html#conf-system-features">system features</a> available on the system this store uses to build derivations.</p>
<p>Example: <code>"kvm"</code></p>
<p><strong>Default:</strong> <em>machine-specific</em></p>
</li>
<li>
<p><span id="store-local-store-trusted"><a href="#store-local-store-trusted"><code>trusted</code></a></span></p>
<p>Whether paths from this store can be used as substitutes
even if they are not signed by a key listed in the
<a href="../../command-ref/conf-file.html#conf-trusted-public-keys"><code>trusted-public-keys</code></a>
setting.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
<li>
<p><span id="store-local-store-want-mass-query"><a href="#store-local-store-want-mass-query"><code>want-mass-query</code></a></span></p>
<p>Whether this store can be queried efficiently for path validity when used as a <a href="../../command-ref/conf-file.html#conf-substituters">substituter</a>.</p>
<p><strong>Default:</strong> <code>false</code></p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../store/types/local-daemon-store.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../store/types/s3-binary-cache-store.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../store/types/local-daemon-store.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../store/types/s3-binary-cache-store.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../redirects.js"></script>



    </div>
    </body>
</html>
