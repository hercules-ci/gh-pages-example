<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Release 0.11 (2007-12-31) - Nix 2.28.3 Reference Manual</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Nix 2.28.3 Reference Manual</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/NixOS/nix" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/NixOS/nix/tree/master/doc/manual/source/release-notes/rl-0.11.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="release-011-2007-12-31"><a class="header" href="#release-011-2007-12-31">Release 0.11 (2007-12-31)</a></h1>
<p>Nix 0.11 has many improvements over the previous stable release. The
most important improvement is secure multi-user support. It also
features many usability enhancements and language extensions, many of
them prompted by NixOS, the purely functional Linux distribution based
on Nix. Here is an (incomplete) list:</p>
<ul>
<li>
<p>Secure multi-user support. A single Nix store can now be shared
between multiple (possible untrusted) users. This is an important
feature for NixOS, where it allows non-root users to install
software. The old setuid method for sharing a store between multiple
users has been removed. Details for setting up a multi-user store
can be found in the manual.</p>
</li>
<li>
<p>The new command <code>nix-copy-closure</code> gives you an easy and efficient
way to exchange software between machines. It copies the missing
parts of the closure of a set of store path to or from a remote
machine via <code>ssh</code>.</p>
</li>
<li>
<p>A new kind of string literal: strings between double single-quotes
(<code>''</code>) have indentation “intelligently” removed. This allows large
strings (such as shell scripts or configuration file fragments in
NixOS) to cleanly follow the indentation of the surrounding
expression. It also requires much less escaping, since <code>''</code> is less
common in most languages than <code>"</code>.</p>
</li>
<li>
<p><code>nix-env</code> <code>--set</code> modifies the current generation of a profile so
that it contains exactly the specified derivation, and nothing else.
For example, <code>nix-env -p /nix/var/nix/profiles/browser --set         firefox</code> lets the profile named <code>browser</code> contain just Firefox.</p>
</li>
<li>
<p><code>nix-env</code> now maintains meta-information about installed packages in
profiles. The meta-information is the contents of the <code>meta</code>
attribute of derivations, such as <code>description</code> or <code>homepage</code>. The
command <code>nix-env -q --xml         --meta</code> shows all meta-information.</p>
</li>
<li>
<p><code>nix-env</code> now uses the <code>meta.priority</code> attribute of derivations to
resolve filename collisions between packages. Lower priority values
denote a higher priority. For instance, the GCC wrapper package and
the Binutils package in Nixpkgs both have a file <code>bin/ld</code>, so
previously if you tried to install both you would get a collision.
Now, on the other hand, the GCC wrapper declares a higher priority
than Binutils, so the former’s <code>bin/ld</code> is symlinked in the user
environment.</p>
</li>
<li>
<p><code>nix-env -i / -u</code>: instead of breaking package ties by version,
break them by priority and version number. That is, if there are
multiple packages with the same name, then pick the package with the
highest priority, and only use the version if there are multiple
packages with the same priority.</p>
<p>This makes it possible to mark specific versions/variant in Nixpkgs
more or less desirable than others. A typical example would be a
beta version of some package (e.g., <code>gcc-4.2.0rc1</code>) which should not
be installed even though it is the highest version, except when it
is explicitly selected (e.g., <code>nix-env -i         gcc-4.2.0rc1</code>).</p>
</li>
<li>
<p><code>nix-env --set-flag</code> allows meta attributes of installed packages to
be modified. There are several attributes that can be usefully
modified, because they affect the behaviour of <code>nix-env</code> or the user
environment build script:</p>
<ul>
<li>
<p><code>meta.priority</code> can be changed to resolve filename clashes (see
above).</p>
</li>
<li>
<p><code>meta.keep</code> can be set to <code>true</code> to prevent the package from
being upgraded or replaced. Useful if you want to hang on to an
older version of a package.</p>
</li>
<li>
<p><code>meta.active</code> can be set to <code>false</code> to “disable” the package.
That is, no symlinks will be generated to the files of the
package, but it remains part of the profile (so it won’t be
garbage-collected). Set it back to <code>true</code> to re-enable the
package.</p>
</li>
</ul>
</li>
<li>
<p><code>nix-env -q</code> now has a flag <code>--prebuilt-only</code> (<code>-b</code>) that causes
<code>nix-env</code> to show only those derivations whose output is already in
the Nix store or that can be substituted (i.e., downloaded from
somewhere). In other words, it shows the packages that can be
installed “quickly”, i.e., don’t need to be built from source. The
<code>-b</code> flag is also available in <code>nix-env -i</code> and <code>nix-env -u</code> to
filter out derivations for which no pre-built binary is available.</p>
</li>
<li>
<p>The new option <code>--argstr</code> (in <code>nix-env</code>, <code>nix-instantiate</code> and
<code>nix-build</code>) is like <code>--arg</code>, except that the value is a string. For
example, <code>--argstr system         i686-linux</code> is equivalent to <code>--arg system         \"i686-linux\"</code> (note that <code>--argstr</code> prevents annoying quoting
around shell arguments).</p>
</li>
<li>
<p><code>nix-store</code> has a new operation <code>--read-log</code> (<code>-l</code>) <code>paths</code> that
shows the build log of the given paths.</p>
</li>
<li>
<p>Nix now uses Berkeley DB 4.5. The database is upgraded
automatically, but you should be careful not to use old versions of
Nix that still use Berkeley DB 4.4.</p>
</li>
<li>
<p>The option <code>--max-silent-time</code> (corresponding to the configuration
setting <code>build-max-silent-time</code>) allows you to set a timeout on
builds — if a build produces no output on <code>stdout</code> or <code>stderr</code> for
the given number of seconds, it is terminated. This is useful for
recovering automatically from builds that are stuck in an infinite
loop.</p>
</li>
<li>
<p><code>nix-channel</code>: each subscribed channel is its own attribute in the
top-level expression generated for the channel. This allows
disambiguation (e.g. <code>nix-env         -i -A nixpkgs_unstable.firefox</code>).</p>
</li>
<li>
<p>The substitutes table has been removed from the database. This makes
operations such as <code>nix-pull</code> and <code>nix-channel --update</code> much, much
faster.</p>
</li>
<li>
<p><code>nix-pull</code> now supports bzip2-compressed manifests. This speeds up
channels.</p>
</li>
<li>
<p><code>nix-prefetch-url</code> now has a limited form of caching. This is used
by <code>nix-channel</code> to prevent unnecessary downloads when the channel
hasn’t changed.</p>
</li>
<li>
<p><code>nix-prefetch-url</code> now by default computes the SHA-256 hash of the
file instead of the MD5 hash. In calls to <code>fetchurl</code> you should pass
the <code>sha256</code> attribute instead of <code>md5</code>. You can pass either a
hexadecimal or a base-32 encoding of the hash.</p>
</li>
<li>
<p>Nix can now perform builds in an automatically generated “chroot”.
This prevents a builder from accessing stuff outside of the Nix
store, and thus helps ensure purity. This is an experimental
feature.</p>
</li>
<li>
<p>The new command <code>nix-store         --optimise</code> reduces Nix store disk space usage by finding identical
files in the store and hard-linking them to each other. It typically
reduces the size of the store by something like 25-35%.</p>
</li>
<li>
<p><code>~/.nix-defexpr</code> can now be a directory, in which case the Nix
expressions in that directory are combined into an attribute set,
with the file names used as the names of the attributes. The command
<code>nix-env         --import</code> (which set the <code>~/.nix-defexpr</code> symlink) is removed.</p>
</li>
<li>
<p>Derivations can specify the new special attribute
<code>allowedReferences</code> to enforce that the references in the output of
a derivation are a subset of a declared set of paths. For example,
if <code>allowedReferences</code> is an empty list, then the output must not
have any references. This is used in NixOS to check that generated
files such as initial ramdisks for booting Linux don’t have any
dependencies.</p>
</li>
<li>
<p>The new attribute <code>exportReferencesGraph</code> allows builders access to
the references graph of their inputs. This is used in NixOS for
tasks such as generating ISO-9660 images that contain a Nix store
populated with the closure of certain paths.</p>
</li>
<li>
<p>Fixed-output derivations (like <code>fetchurl</code>) can define the attribute
<code>impureEnvVars</code> to allow external environment variables to be passed
to builders. This is used in Nixpkgs to support proxy configuration,
among other things.</p>
</li>
<li>
<p>Several new built-in functions: <code>builtins.attrNames</code>,
<code>builtins.filterSource</code>, <code>builtins.isAttrs</code>, <code>builtins.isFunction</code>,
<code>builtins.listToAttrs</code>, <code>builtins.stringLength</code>, <code>builtins.sub</code>,
<code>builtins.substring</code>, <code>throw</code>, <code>builtins.trace</code>,
<code>builtins.readFile</code>.</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../release-notes/rl-0.12.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../release-notes/rl-0.10.1.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../release-notes/rl-0.12.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../release-notes/rl-0.10.1.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../redirects.js"></script>


    </div>
    </body>
</html>
